<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- 上述3个meta标签*必须*放在最前面，任何其他内容都*必须*跟随其后！ -->
    <title>Word Cloud</title>

    <link rel="stylesheet" href="base.css">

    <style>

        .textarea {
            height: 200px;
            width: 600px;
            border-top: solid 1px #E5EBEE;
        }

        #word-cloud-img {
            margin-top: 10px;
            width: 800px;
            min-height:600px;
        }
    </style>

</head>

<body class="container">

    <h1>字体云生成器</h1>

    <p>将需要生成的内容每段使用英文逗号(<b>,</b>)隔开，点击可在下方生成对应的字体云图片(右键可保存图片)</p>
    <p>例如：你今天真好看,最好的告别,你一生的故事,最后的耍猴人,局外人,夜莺与玫瑰,岛上书店,无声告白</p>

    <textarea class="textarea" id="original" placeholder="请输入内容，使用逗号隔开……"></textarea>

    <br/>

    <button id="gen" class="btn">生成</button>

    <!-- 为 ECharts 准备一个具备大小（宽高）的 DOM -->
    <div id="word-cloud-img"></div>

</body>

<script type="text/javascript" src="../static/libs/jQuery/jquery-2.2.3.min.js"></script>
<script src="../static/libs/echarts/echarts.min.js"></script>
<script src="../static/libs/echarts/echarts-wordcloud.min.js"></script>

<script>
    $(function () {
        // 基于准备好的dom，初始化echarts实例
        var myChart = echarts.init(document.getElementById('word-cloud-img'));

        /**
         * 生成字体云
         */
        $("#gen").on('click', function () {

            var text = $("#original").val().trim();
            if(text.length <= 0) {
                console.log("输入内容为空。。。");
            } else {
                //set css
                $("#word-cloud-img").css("min-width", "800px").css("min-height", "600px");
                var option = {
                    tooltip: {},
                    series: [ {
                        type: 'wordCloud',
                        gridSize: 2,
                        sizeRange: [12, 50],
                        rotationRange: [-90, 90],
                        shape: 'pentagon',
                        width: 800,
                        height: 600,
                        textStyle: {
                            normal: {
                                color: function () {
                                    return 'rgb(' + [
                                            Math.round(Math.random() * 160),
                                            Math.round(Math.random() * 160),
                                            Math.round(Math.random() * 160)
                                        ].join(',') + ')';
                                }
                            },
                            emphasis: {
                                shadowBlur: 10,
                                shadowColor: '#333'
                            }
                        },
                        data: buildDataArray(text)
                    } ]
                };
                myChart.setOption(option);
            }
        });

        /**
         * 构建数据数组
         * @param text
         * @returns {Array}
         */
        function buildDataArray(text) {
            var dataArray = [];
            var array = text.split(",");

            for(var index in array) {
                var data = {};
                var name = array[index];
                if("" == name.trim()) {
                    console.log("Ignore empty content!");
                } else {
                    data.name = name;
                    data.value = Math.round(Math.random() * 160) +10;
                    dataArray.push(data);
                }
            }
            return dataArray;
        }

    });


</script>

</html>




