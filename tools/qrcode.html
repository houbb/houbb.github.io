<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>二维码</title>


    <script type="text/javascript" src="../static/libs/jQuery/jquery-2.2.3.min.js"></script>
    <script type="text/javascript" src="../static/libs/qrcode/jquery.qrcode.js"></script>
    <script type="text/javascript" src="../static/libs/qrcode/qrcode.js"></script>

    <style>
        textarea {
            height: 200px;
            width: 700px;
            resize: none;
            margin-right: 20px;

            border: 0;
            border-top: solid 1px #E5EBEE;
            border-left: solid 1px #E5EBEE;
            border-right: solid 1px #E5EBEE;
            border-bottom: solid 1px #eee;
            border-radius: 0;
            outline: none;
            font-size: 10px;
        }

        button {
            display: inline-block;
            padding: 6px 12px;
            margin-bottom: 0;
            font-size: 14px;
            font-weight: 400;
            line-height: 1.42857143;
            text-align: center;
            white-space: nowrap;
            vertical-align: middle;
            -ms-touch-action: manipulation;
            touch-action: manipulation;
            cursor: pointer;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
            background-image: none;
            border: 1px solid transparent;
            border-radius: 4px;

            /*success*/
            color: #fff;
            background-color: #5cb85c;
            border-color: #4cae4c;
        }
        button:hover {
            color: #fff;
            background-color: #449d44;
            border-color: #398439;
        }

        #qr-code {
            margin-top: 50px;
            width: 250px;
            height: 250px;
        }

    </style>

</head>

<body>

<p>请输入需要转换的文本，点击按钮可以生成对应的二维码。</p>

<textarea id="original" placeholder="请输入需要转换的文本"></textarea>

<br/>

<button>生成</button>


<div id="qr-code"></div>

<script>

    $(function () {
        $("button").on('click', function () {
            var text = $("#original").val().trim();
            if(text.length <= 0) {
                console.log("输入内容为空。。。");
            } else {
                var utf8Text = utf16To8(text);
                $("#qr-code").qrcode({
                    text: utf8Text
                });
            }
        });

        /**
         * 将UTF-16进制转换为UTF-8
         * @param str
         * @returns {string}
         */
        var utf16To8 = function(str) {
            var out, i, len, c;
            out = "";
            len = str.length;
            for(i = 0; i < len; i++) {
                c = str.charCodeAt(i);
                if ((c >= 0x0001) && (c <= 0x007F)) {
                    out += str.charAt(i);
                } else if (c > 0x07FF) {
                    out += String.fromCharCode(0xE0 | ((c >> 12) & 0x0F));
                    out += String.fromCharCode(0x80 | ((c >>  6) & 0x3F));
                    out += String.fromCharCode(0x80 | ((c >>  0) & 0x3F));
                } else {
                    out += String.fromCharCode(0xC0 | ((c >>  6) & 0x1F));
                    out += String.fromCharCode(0x80 | ((c >>  0) & 0x3F));
                }
            }
            return out;
        }


    });

</script>

</body>

</html>




