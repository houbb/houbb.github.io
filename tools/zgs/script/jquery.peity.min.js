!function(F,e,M,x){var a=F.fn.peity=function(e,n){return i&&this.each(function(){var t=F(this),i=t.data("_peity");i?(e&&(i.type=e),F.extend(i.opts,n)):(i=new r(t,e,F.extend({},a.defaults[e],t.data("peity"),n)),t.change(function(){i.draw()}).data("_peity",i)),i.draw()}),this},r=function(t,i,e){this.$el=t,this.type=i,this.opts=e},t=r.prototype,S=t.svgElement=function(t,i){return F(e.createElementNS("http://www.w3.org/2000/svg",t)).attr(i)},i="createElementNS"in e&&S("svg",{})[0].createSVGRect;t.draw=function(){var t=this.opts;a.graphers[this.type].call(this,t),t.after&&t.after.call(this,t)},t.fill=function(){var e=this.opts.fill;return F.isFunction(e)?e:function(t,i){return e[i%e.length]}},t.prepare=function(t,i){return this.$svg||this.$el.hide().after(this.$svg=S("svg",{class:"peity"})),this.$svg.empty().data("_peity",this).attr({height:i,width:t})},t.values=function(){return F.map(this.$el.text().split(this.opts.delimiter),function(t){return parseFloat(t)})},a.defaults={},a.graphers={},a.register=function(t,i,e){this.defaults[t]=i,this.graphers[t]=e},a.register("pie",{fill:["#ff9900","#fff4dd","#ffc66e"],radius:8},function(t){if(!t.delimiter){var i=this.$el.text().match(/[^0-9\.]/);t.delimiter=i?i[0]:","}var e=F.map(this.values(),function(t){return 0<t?t:0});if("/"==t.delimiter){var n=e[0],a=e[1];e=[n,M.max(0,a-n)]}for(var r=0,h=e.length,s=0;r<h;r++)s+=e[r];s||(h=2,e=[0,s=1]);var l=2*t.radius,p=this.prepare(t.width||l,t.height||l),o=p.width()/2,f=p.height()/2,c=M.min(o,f),u=t.innerRadius;"donut"!=this.type||u||(u=.5*c);var d=M.PI,g=this.fill(),v=this.scale=function(t,i){var e=t/s*d*2-d/2;return[i*M.cos(e)+o,i*M.sin(e)+f]},m=0;for(r=0;r<h;r++){var y,w=e[r],x=w/s;if(0!=x){if(1==x)if(u){var k=o-.01,$=f-c,j=f-u;y=S("path",{d:["M",o,$,"A",c,c,0,1,1,k,$,"L",k,j,"A",u,u,0,1,0,o,j].join(" "),"data-value":w})}else y=S("circle",{cx:o,cy:f,"data-value":w,r:c});else{var A=m+w,E=["M"].concat(v(m,c),"A",c,c,0,.5<x?1:0,1,v(A,c),"L");u?E=E.concat(v(A,u),"A",u,u,0,.5<x?1:0,0,v(m,u)):E.push(o,f),m+=w,y=S("path",{d:E.join(" "),"data-value":w})}y.attr("fill",g.call(this,w,r,e)),p.append(y)}}}),a.register("donut",F.extend(!0,{},a.defaults.pie),function(t){a.graphers.pie.call(this,t)}),a.register("line",{delimiter:",",fill:"#c6d9fd",height:16,min:0,stroke:"#4d89f9",strokeWidth:1,width:32},function(t){var i=this.values();1==i.length&&i.push(i[0]);for(var e=M.max.apply(M,t.max==x?i:i.concat(t.max)),n=M.min.apply(M,t.min==x?i:i.concat(t.min)),a=this.prepare(t.width,t.height),r=t.strokeWidth,h=a.width(),s=a.height()-r,l=e-n,p=this.x=function(t){return t*(h/(i.length-1))},o=this.y=function(t){var i=s;return l&&(i-=(t-n)/l*s),i+r/2},f=o(M.max(n,0)),c=[0,f],u=0;u<i.length;u++)c.push(p(u),o(i[u]));c.push(h,f),t.fill&&a.append(S("polygon",{fill:t.fill,points:c.join(" ")})),r&&a.append(S("polyline",{fill:"none",points:c.slice(2,c.length-2).join(" "),stroke:t.stroke,"stroke-width":r,"stroke-linecap":"square"}))}),a.register("bar",{delimiter:",",fill:["#4D89F9"],height:16,min:0,padding:.1,width:32},function(t){for(var i=this.values(),e=M.max.apply(M,t.max==x?i:i.concat(t.max)),n=M.min.apply(M,t.min==x?i:i.concat(t.min)),a=this.prepare(t.width,t.height),r=a.width(),h=a.height(),s=e-n,l=t.padding,p=this.fill(),o=this.x=function(t){return t*r/i.length},f=this.y=function(t){return h-(s?(t-n)/s*h:1)},c=0;c<i.length;c++){var u,d=o(c+l),g=o(c+1-l)-d,v=i[c],m=f(v),y=m,w=m;s?v<0?y=f(M.min(e,0)):w=f(M.max(n,0)):u=1,0==(u=w-y)&&(u=1,0<e&&s&&y--),a.append(S("rect",{"data-value":v,fill:p.call(this,v,c,i),x:d,y:y,width:g,height:u}))}})}(jQuery,document,Math);