function main(){jsGame.initImage([{id:"a",src:"img/a.png?d"},{id:"die",src:"img/die.png"},{id:"anniu_1",src:"img/anniu_1.png"},{id:"clue",src:"img/clue.png"},{id:"beijing",src:"img/di.png"},{id:"zuoqiang",src:"img/q_1.png"},{id:"youqiang",src:"img/q_2.png"},{id:"zuorole",src:"img/p_2.png"},{id:"yourole",src:"img/p_1.png"},{id:"zuoyouf",src:"img/f_1.png"},{id:"youzuof",src:"img/f_2.png"},{id:"zuozhang",src:"img/za_2.png"},{id:"youzhang",src:"img/za_1.png"},{id:"zuopao",src:"img/d_2.png"},{id:"youpao",src:"img/d_1.png"},{id:"zuoyouniao",src:"img/n_1.png"},{id:"youzuoniao",src:"img/n_2.png"},{id:"kill1",src:"img/b_1.png"},{id:"kill2",src:"img/b_2.png"},{id:"kill3",src:"img/b_3.png"},{id:"kill4",src:"img/b_4.png"},{id:"kill5",src:"img/b_5.png"},{id:"kill6",src:"img/b_6.png"},{id:"kill7",src:"img/b_7.png"},{id:"kill8",src:"img/b_8.png"},{id:"boom",src:"img/y_1.png"},{id:"di_2",src:"img/di_2.png?d"},{id:"di_1",src:"img/di_1.png"},{id:"a_1",src:"img/an_0.png"},{id:"k_1",src:"img/k_1.png"},{id:"k_2",src:"img/k_2.png"},{id:"dg",src:"img/dg.png"},{id:"cw_1",src:"img/cw_1.png"},{id:"cw",src:"img/cw.png?d"},{id:"numb",src:"img/zi_1.png"},{id:"nums",src:"img/zi_2.png"},{id:"l",src:"img/l.png"},{id:"ym",src:"img/ym.png"},{id:"jx",src:"img/jx.png"},{id:"an_5",src:"img/an_5.png"},{id:"an_1",src:"img/an_1.png"},{id:"an_2",src:"img/an_2.png"},{id:"an_3",src:"img/an_3.png"},{id:"an_4",src:"img/an_4.png"},{id:"zt",src:"img/zt.png"},{id:"clue1",src:"img/clue1.png"},{id:"btn_sound1",src:"img/an_6.png"},{id:"btn_sound2",src:"img/an_7.png"},{id:"fh_3",src:"img/fh_3.png"},{id:"pp",src:"img/pp.png"}]).setRunFrequency(jsGame.canvas.screen.getTouch()?50:80);var e={},t=0;e.initTouch=function(){jsGame.touch.init(!1)};e.initCanvas=function(){e.height=416>window.innerHeight?window.innerHeight+60:window.innerHeight;e.width=window.innerWidth;window.scrollTo(0,-5);e.offset=0;e.scale=0;window.orientation&&0!=window.orientation?e.clue=!0:(e.height>1.5*e.width?(e.scale=e.width/320,e.offset=(e.height-1.5*e.width)/2<<0,e.height=1.5*e.width<<0):(e.width=2/3*e.height<<0,e.scale=e.height/480),e.portrait=!0,e.clue=!1);jsGame.canvas.screen.setWidth(e.width);jsGame.canvas.screen.setHeight(e.height);e.canvas=document.getElementById("jsGameScreen");e.ctx=e.canvas.getContext("2d");e.buffer=document.createElement("canvas");e.buffer.width=320;e.buffer.height=480;e.ctxBuf=e.buffer.getContext("2d");e.initTouch()};e.initCanvas();jsGame.initImageCallBack(function(t,n){if(t>=n)jsGame.gameFlow.run();else try{var r=t/n,r=1<r?1:r;e.ctx.fillStyle="#000";e.ctx.fillRect(0,0,window.innerWidth,window.innerHeight);e.ctx.drawImage(jsGame.getImage("a"),0,0,250,81,(e.width-250)/2,(e.height-81)/2,250,81);e.ctx.drawImage(jsGame.getImage("a"),2,86,246*r,10,(e.width-246)/2,(e.height-81)/2+51,246*r,10)}catch(i){}});jsGame.pageLoad(function(n){function r(){e.addRole=50;e.addZhang=90;e.addBird=130;E=b=e.time=0;T=new f;x=new o;e.enemyData=[];e.boomData=[];e.protection=[];e.inKill=0;e.isLose=!1;i(v)}function i(r){y=r;switch(y){case h:N=new l;e.createMenuPage();-1==navigator.userAgent.toLowerCase().indexOf("iphone")&&-1==navigator.userAgent.toLowerCase().indexOf("ipod")||window.navigator.standalone;break;case p:C=new c(p);break;case v:e.createGamePage();e.delClueDialog();break;case d:C=new c(d);e.createPausePage();break;case g:t=b,C=new c(m),e.createLosePage(),w<b&&(w=b,n.localStorage.setItem("renzhe_bastScore",""+w)),dp_submitScore(b)}}function s(t,r){this.x=t;this.y=r;this.index=-1;this.width=130;this.height=84;this.isOut=function(){return 4>=this.index?!1:!0};this.cycle=function(){this.x>e.buffer.width-this.width&&(this.x=e.buffer.width-this.width);this.index++;this.y+=T.speed};this.draw=function(){-1!=this.index&&e.ctxBuf.drawImage(n.getImage("boom"),this.index*this.width,0,this.width,this.height,this.x,this.y,this.width,this.height)}}function o(){this.inity=300;this.x=T.width;this.y=e.buffer.height;this.flyIndex=this.actIndex=0;this.width=48;this.height=43;this.isPosition=this.stay=0;this.leftx=T.width;this.lefty=this.inity;this.flySpeed=30;this.vy=0;this.svy=9;this.body=[0,0,this.width,this.height];this._imgActRole=n.getImage("zuorole");this._imgFlyRole=n.getImage("zuoyouf");this.kill=function(){return 3==e.inKill?!0:!1};this.killNameIndex=0;this.imgKillWH=n.getImage(D[this.killNameIndex]);this.excursion=function(){var t=this.x,n=this.x+this.width;switch(this.stay){case L:n<(e.buffer.width>>1)-this.width?this.y+=this.svy:n>(e.buffer.width>>1)+this.width&&(this.y-=this.svy);break;case A:t<(e.buffer.width>>1)-this.width?this.y-=this.svy:t>(e.buffer.width>>1)+this.width&&(this.y+=this.svy)}};this.killX=0;this.killY=e.buffer.height;this.killWidth=e.buffer.width;this.killHeight=e.buffer.height;this.timeKillEnd=10;this.iskillend=!0;this.leftx=T.width;this.lefty=this.inity;this.rightx=e.buffer.width-T.width-_[this.flyIndex][2];this.righty=this.inity;this.cycle=function(){if(this.kill())this.iskillend&&(this.x=e.buffer.width-_[0][2]>>1,this.y=0,this.vx=((this.stay==L?T.width:e.buffer.width-T.width-_[0][2])-(e.buffer.width-_[0][2]>>1))/this.timeKillEnd,this.vy=this.inity/this.timeKillEnd,this.iskillend=!1),this.killNameIndex<=D.length?this.killNameIndex++:(this.y+=this.vy,this.x+=this.vx,this.flyIndex++,this.flyIndex%=_.length-1,this.y>=this.inity&&(this.killY=e.buffer.height,e.inKill=0,this.stay==L?(this._imgActRole=n.getImage("zuorole"),this.x=this.leftx=T.width,this.y=this.lefty=this.inity,this.isPosition=0):(this._imgActRole=n.getImage("yourole"),this.x=this.rightx=this.x=e.buffer.width-T.width-x.width,this.y=this.righty=this.inity,this.isPosition=1),this.stay=k,this.iskillend=!0,this.killNameIndex=0));else switch(this.stay){case k:this.actIndex++;this.actIndex%=O.length-1;this.body=[0,0,this.width,this.height];0==this.isPosition?this.x=T.width:1==this.isPosition&&(this.x=e.buffer.width-T.width-x.width);break;case L:this.flyIndex++;this.flyIndex%=_.length-1;this.body=[30,0,_[this.flyIndex][2]-60,this.height];this.x-=this.flySpeed;this.excursion();this.x<=T.width&&(this._imgFlyRole=n.getImage("zuoyouf"),this.x=this.leftx=T.width,this.y=this.lefty=this.inity,this.isPosition=0,this._imgActRole=n.getImage("zuorole"),this.stay=k);break;case A:this.flyIndex++,this.flyIndex%=_.length-1,this.body=[30,0,_[this.flyIndex][2]-60,this.height],this.x+=this.flySpeed,this.excursion(),this.x>=e.buffer.width-T.width-_[this.flyIndex][2]&&(this._imgFlyRole=n.getImage("youzuof"),this.x=this.rightx=this.x=e.buffer.width-T.width-x.width,this.y=this.righty=this.inity,this.isPosition=1,this._imgActRole=n.getImage("yourole"),this.stay=k)}};this.draw=function(){this.kill()?this.killNameIndex<=D.length-1?e.ctxBuf.drawImage(n.getImage(D[this.killNameIndex]),e.buffer.width-this.imgKillWH.width>>1,e.buffer.height-this.imgKillWH.height):e.ctxBuf.drawImage(this._imgFlyRole,_[this.flyIndex][0],_[this.flyIndex][1],_[this.flyIndex][2],_[this.flyIndex][3],this.x,this.y,_[this.flyIndex][2],_[this.flyIndex][3]):y==v?this.stay==k?(e.ctxBuf.drawImage(this._imgActRole,O[this.actIndex][0],O[this.actIndex][1],O[this.actIndex][2],O[this.actIndex][3],this.x,this.y,O[this.actIndex][2],O[this.actIndex][3]),this.protection&&e.ctxBuf.drawImage(n.getImage("pp"),this.x-2,this.y-7)):(e.ctxBuf.drawImage(this._imgFlyRole,_[this.flyIndex][0],_[this.flyIndex][1],_[this.flyIndex][2],_[this.flyIndex][3],this.x,this.y,_[this.flyIndex][2],_[this.flyIndex][3]),this.protection&&(this.stay==L?e.ctxBuf.drawImage(n.getImage("pp"),this.x+32,this.y-2):e.ctxBuf.drawImage(n.getImage("pp"),this.x+42,this.y-2))):y==g&&(0==this.isPosition||this.stay==L?e.ctxBuf.drawImage(n.getImage("die"),0,0,48,38,this.x,this.y,48,38):e.ctxBuf.drawImage(n.getImage("die"),48,0,48,38,this.x,this.y,48,38))}}function u(t,r){this.type=t;this.isPosition=r;this.qiangType=this.imgQiang=0==this.isPosition?n.getImage("zuozhang"):n.getImage("youzhang");this.direnIndex=0;this.renType=this.imgDiren=0==this.isPosition?n.getImage("zuopao"):n.getImage("youpao");this.niaoIndex=0;this.niaoType=this.imgNiao=0==this.isPosition?n.getImage("zuoyouniao"):n.getImage("youzuoniao");switch(this.type){case P:this.width=j[this.direnIndex][2];this.height=j[this.direnIndex][3];this.bodyRect=[0,0,this.width,this.height];break;case H:this.height=this.width=50;this.bodyRect=[0,F[0][2]-this.width>>1,this.width,this.height];break;case B:this.width=this.qiangType.width,this.height=this.qiangType.height,this.bodyRect=[0,0,this.width,this.height]}this.birdIny=this.height;if(0==this.isPosition)switch(this.type){case P:this.x=T.width;this.y=-this.height;break;case H:this.x=this.birdInx=-this.width;this.y=this.birdIny;break;case B:this.x=0,this.y=-this.height}else if(1==this.isPosition)switch(this.type){case P:this.x=e.buffer.width-T.width-this.width;this.y=-this.height;break;case H:this.x=this.birdInx=e.buffer.width;this.y=this.birdIny;break;case B:this.x=e.buffer.width-this.width,this.y=-this.height}this.a=1==r?x.leftx:x.rightx;this.b=1==r?x.lefty:x.righty;this.vx=(this.a-this.birdInx)/10;this.vy=(this.b-this.birdIny)/10;this.enemySpeed=35;this.isAttack=function(e,t,n,r){return this.y+this.bodyRect[1]>=t+r||t>=this.y+this.bodyRect[1]+this.bodyRect[3]||this.x+this.bodyRect[0]>=e+n||e>=this.x+this.bodyRect[0]+this.bodyRect[2]?!1:!0};this.cycle=function(){switch(this.type){case P:this.direnIndex++;this.direnIndex%=j.length;this.y+=this.enemySpeed;break;case H:this.niaoIndex++;this.niaoIndex%=F.length;this.x+=this.vx;this.y+=this.vy;break;case B:this.y+=T.speed}};this.draw=function(){switch(this.type){case P:e.ctxBuf.drawImage(this.imgDiren,j[this.direnIndex][0],j[this.direnIndex][1],j[this.direnIndex][2],j[this.direnIndex][3],this.x,this.y,j[this.direnIndex][2],j[this.direnIndex][3]);break;case H:e.ctxBuf.drawImage(this.imgNiao,F[this.niaoIndex][0],F[this.niaoIndex][1],F[this.niaoIndex][2],F[this.niaoIndex][3],this.x,this.y,F[this.niaoIndex][2],F[this.niaoIndex][3]);break;case B:e.ctxBuf.drawImage(this.imgQiang,0,0,this.qiangType.width,this.qiangType.height,this.x,this.y,this.qiangType.width,this.qiangType.height)}}}function f(){this.y=0;this.width=30;this.height=580;this.speed=25;this.zuoqiang=n.getImage("zuoqiang");this.youqiang=n.getImage("youqiang");this.cycle=function(){this.y+=this.speed;this.y>=this.zuoqiang.height&&(this.y=0)};this.draw=function(){e.ctxBuf.drawImage(n.getImage("zuoqiang"),0,0,this.zuoqiang.width,this.zuoqiang.height,0,this.y,this.zuoqiang.width,this.zuoqiang.height);e.ctxBuf.drawImage(n.getImage("zuoqiang"),0,0,this.zuoqiang.width,this.zuoqiang.height,0,this.y-this.zuoqiang.height,this.zuoqiang.width,this.zuoqiang.height);e.ctxBuf.drawImage(n.getImage("youqiang"),0,0,this.youqiang.width,this.youqiang.height,e.buffer.width-this.youqiang.width,this.y,this.youqiang.width,this.youqiang.height);e.ctxBuf.drawImage(n.getImage("youqiang"),0,0,this.youqiang.width,this.youqiang.height,e.buffer.width-this.youqiang.width,this.y-this.youqiang.height,this.youqiang.width,this.youqiang.height)}}function l(){this.imgMenubiao=n.getImage("di_2");this.biaox=e.buffer.width-this.imgMenubiao.width>>1;this.biaoy=30;this.imgMenuXia=n.getImage("di_1");this.xiax=e.buffer.width-this.imgMenuXia.width>>1;this.xiay=e.buffer.height-this.imgMenuXia.height;this.button=n.getImage("a_1");this.buttonx=e.buffer.width-this.button.width>>1;this.buttony=this.biaoy+this.imgMenubiao.height+30;this.buttony2=this.biaoy+this.imgMenubiao.height+120;this.isState=!1;this.stateIndex=1;this.knife=n.getImage("dg");this.knifeX=e.buffer.width-this.knife.width>>1;this.knifeY=this.biaoy;this.stap=0;this.k_1_x=(e.buffer.width>>1)-120;this.k_1_y=this.buttony;this.t_1_x=(e.buffer.width>>1)-67;this.t_1_y=this.buttony2;this.vx1=-5;this.vy1=30;this.k_2_x=e.buffer.width>>1;this.k_2_y=this.k_1_y;this.vx2=5;this.vy2=40;this.zuoqiang=n.getImage("zuoqiang");this.youqiang=n.getImage("youqiang");this.zuoqiangX=-this.zuoqiang.width;this.youqiangX=e.buffer.width;this.cycle=function(){switch(this.stap){case 0:this.isState&&(this.knifeY+=40,this.knifeY>e.buffer.height-this.knife.height&&(this.stap=1));break;case 1:this.k_1_x+=this.vx1;this.k_1_y+=this.vy1;this.k_2_x+=this.vx2;this.k_2_y+=this.vy2;3>this.stateIndex&&0==e.time%2&&this.stateIndex++;this.k_1_y>e.buffer.height&&(this.biaoy-=20,this.xiay+=20,this.biaoy<-this.imgMenubiao.height&&(this.stap=2));break;case 2:this.zuoqiangX+=6,this.youqiangX-=6,0<=this.zuoqiangX&&(e.time=0,i(p))}};this.draw=function(){e.ctxBuf.drawImage(n.getImage("di_2"),this.biaox,this.biaoy);e.ctxBuf.drawImage(n.getImage("di_1"),this.xiax,this.xiay);switch(this.stap){case 0:e.ctxBuf.drawImage(n.getImage("a_1"),this.buttonx,this.buttony);e.ctxBuf.drawImage(n.getImage("fh_3"),this.t_1_x,this.t_1_y);this.isState&&e.ctxBuf.drawImage(n.getImage("dg"),this.knifeX,this.knifeY);break;case 1:e.ctxBuf.drawImage(n.getImage("k_1"),120*this.stateIndex,0,120,120,this.k_1_x,this.k_1_y,120,120);e.ctxBuf.drawImage(n.getImage("k_2"),120*this.stateIndex,0,120,120,this.k_2_x,this.k_2_y,120,120);break;case 2:e.ctxBuf.drawImage(n.getImage("zuoqiang"),0,0,this.zuoqiang.width,this.zuoqiang.height,this.zuoqiangX,0,this.zuoqiang.width,this.zuoqiang.height),e.ctxBuf.drawImage(n.getImage("youqiang"),0,0,this.youqiang.width,this.youqiang.height,this.youqiangX,0,this.youqiang.width,this.youqiang.height)}}}function c(t){this.imgJZ=n.getImage("cw_1");this.imgLose=n.getImage("cw");this.imgHelp=n.getImage("jx");this.imgPause=n.getImage("zt");this.winvy=this.winvx=this.winy=this.winx=0;this.winw=this.imgLose.width;this.winh=0;this.isLose=!1;this.cw_1_x=e.buffer.width-this.imgJZ.width>>1;this.cw_1_y1=(e.buffer.height>>1)-this.imgJZ.height;this.cw_1_y2=e.buffer.height>>1;this.helpvy=this.helpvx=this.helpy=this.helpx=0;this.helpw=this.imgHelp.width;this.helph=0;this.isHelp=!1;this.pausevy=this.pausevx=this.pausey=this.pausex=0;this.pausew=this.imgPause.width;this.pauseh=0;this.type=t;this.speed=12;this.cycle=function(){switch(y){case p:this.helph+=2*this.speed;this.helpy=(this.imgHelp.height-this.helph)/2;this.helph>this.imgHelp.height&&(this.helph=this.imgHelp.height,this.speed=this.helpy=0,this.isHelp=!0);this.cw_1_y1-=this.speed;this.cw_1_y2+=this.speed;break;case d:this.pauseh+=2*this.speed;this.pausey=(this.imgPause.height-this.pauseh)/2;this.pauseh>this.imgPause.height&&(this.pauseh=this.imgPause.height,this.speed=this.pausey=0,this.ispause=!0);this.cw_1_y1-=this.speed;this.cw_1_y2+=this.speed;break;case g:this.winh+=2*this.speed,this.winy=(this.imgLose.height-this.winh)/2,this.winh>this.imgLose.height&&(this.winh=this.imgLose.height,this.speed=this.winy=0,this.isLose=!0),this.cw_1_y1-=this.speed,this.cw_1_y2+=this.speed}};this.draw=function(){switch(y){case p:e.ctxBuf.drawImage(n.getImage("jx"),this.helpx,this.helpy,this.helpw,this.helph,e.buffer.width-this.imgHelp.width>>1,e.buffer.height-this.helph>>1,this.helpw,this.helph);e.ctxBuf.drawImage(n.getImage("cw_1"),this.cw_1_x,this.cw_1_y1);e.ctxBuf.drawImage(n.getImage("cw_1"),this.cw_1_x,this.cw_1_y2);break;case d:e.ctxBuf.drawImage(n.getImage("zt"),this.pausex,this.pausey,this.pausew,this.pauseh,e.buffer.width-this.imgPause.width>>1,e.buffer.height-this.pauseh>>1,this.pausew,this.pauseh);e.ctxBuf.drawImage(n.getImage("cw_1"),this.cw_1_x,this.cw_1_y1);e.ctxBuf.drawImage(n.getImage("cw_1"),this.cw_1_x,this.cw_1_y2);break;case g:e.ctxBuf.drawImage(n.getImage("cw"),this.winx,this.winy,this.winw,this.winh,e.buffer.width-this.imgLose.width>>1,e.buffer.height-this.winh>>1,this.winw,this.winh),e.ctxBuf.drawImage(n.getImage("cw_1"),this.cw_1_x,this.cw_1_y1),e.ctxBuf.drawImage(n.getImage("cw_1"),this.cw_1_x,this.cw_1_y2),R("numb",225,208,b,!0),R("nums",135,254,w,!1)}}}var h=100,p=101,d=102,v=1e3,m=1001,g=1002,y=0,b,w=0,E,S=0;e.scaleTmp=0;e.initMusic=function(){for(var t=0;1>t;t++){e.music[t]=document.createElement("audio");var n="";switch(t){case 0:n="sound/bg.mp3"}e.music[t].setAttribute("src",n);e.music[t].setAttribute("preload",!0);e.music[t].load()}e.music[0].setAttribute("autoplay",!0);e.music[0].setAttribute("loop",!0);e.music[0].addEventListener("canplaythrough",function(){e.sound?e.music[0].play():e.music[0].pause()},!0)};e.musicControl=function(){e.sound?e.music[0].play():e.music[0].pause()};n.touch.touchStart(function(){var t=n.touch.getStartPos();t.x/=e.scale;t.y=(t.y-e.offset)/e.scale;if(!e.clue){var s=t.x,t=t.y;console.log(s,t);console.log("ok="+y);console.log("C="+p);switch(y){case h:e.btns.btn_sound&&266<s&&320>s&&10<t&&66>t?e.btns.btn_sound.pressed=1:e.btns.btn_clue1&&80<s&&240>s&&410<t&&480>t?e.delClueDialog():70<s&&248>s&&210<t&&290>t?N.isState=!0:95<s&&220>s&&305<t&&340>t&&goHome();break;case p:(0<s||0<t)&&C.isHelp&&(e.ctxBuf.drawImage(n.getImage("an_5"),250,122),r(E),i(v));break;case v:e.btns.btn_pause&&280<s&&320>s&&440<t&&480>t?e.btns.btn_pause.pressed=1:x.y<=x.inity&&(0==x.isPosition?x.stay=A:1==x.isPosition&&(x.stay=L));break;case d:e.btns.btn_back&&54<s&&150>s&&230<t&&256>t?e.btns.btn_back.pressed=1:e.btns.btn_resume&&174<s&&270>s&&230<t&&256>t&&(e.btns.btn_resume.pressed=1);break;case g:C.isLose&&(e.btns.btn_back1&&50<s&&146>s&&284<t&&310>t?e.btns.btn_back1.pressed=1:e.btns.btn_restart&&dp_share(w)&&174<s&&270>s&&284<t&&310>t&&(e.btns.btn_restart.pressed=1))}}});n.touch.touchEnd(function(){var t=n.touch.getReleasePos();t.x/=e.scale;t.y=(t.y-e.offset)/e.scale;if(!e.clue){var s=t.x,t=t.y;switch(y){case h:e.btns.btn_sound.pressed&&266<s&&320>s&&10<t&&66>t&&(e.sound=!e.sound,e.btns.btn_sound.img=e.sound?n.getImage("btn_sound1"):n.getImage("btn_sound2"));e.btns.btn_sound&&(e.btns.btn_sound.pressed=0);e.musicControl();break;case v:e.btns.btn_pause.pressed&&s>e.buffer.width-40&&s<e.buffer.width&&t>e.buffer.height-40&&t<e.buffer.height&&i(d);e.btns.btn_pause&&(e.btns.btn_pause.pressed=0);break;case g:C.isLose&&(e.btns.btn_back1&&50<s&&146>s&&284<t&&310>t?i(h):e.btns.btn_restart&&174<s&&270>s&&284<t&&310>t&&(r(E),i(v)));e.btns.btn_back1&&(e.btns.btn_back1.pressed=0);e.btns.btn_restart&&(e.btns.btn_restart.pressed=0);break;case d:e.btns.btn_back.pressed&&54<s&&150>s&&230<t&&256>t?i(h):e.btns.btn_resume.pressed&&174<s&&270>s&&230<t&&256>t&&i(v),e.btns.btn_back&&(e.btns.btn_back.pressed=0),e.btns.btn_resume&&(e.btns.btn_resume.pressed=0)}}});e.drawBtns=function(t){e.ctxBuf.drawImage(t.img,t.pressed*t.w,0,t.w,t.h,t.x,t.y,t.w,t.h)};e.drawBtn=function(t){0!=t.pressed&&e.ctxBuf.drawImage(t.img,t.x,t.y)};e.createClueDialog=function(){e.btns.btn_clue1||(e.btns.btn_clue1={img:n.getImage("clue1"),x:160,y:446,w:156,h:63})};e.delClueDialog=function(){e.btns.btn_clue1&&(e.btns.btn_clue1=null)};e.showClueDialog=function(){e.btns.btn_clue1&&e.ctxBuf.drawImage(e.btns.btn_clue1.img,82,415)};e.createMenuPage=function(){e.btns.btn_sound||(e.btns.btn_sound={img:n.getImage("btn_sound1"),x:276,y:16,w:40,h:40,pressed:0},e.btns.btn_sound.img=e.sound?n.getImage("btn_sound1"):n.getImage("btn_sound2"))};e.delMenuPage=function(){e.btns.btn_sound&&(e.btns.btn_sound=null)};e.showMenuPage=function(){e.btns.btn_sound&&!N.isState&&e.drawBtns(e.btns.btn_sound)};e.createGamePage=function(){e.btns.btn_pause||(e.btns.btn_pause={img:n.getImage("an_1"),x:e.buffer.width-40,y:e.buffer.height-40,w:40,h:40,pressed:0})};e.delGamePage=function(){e.btns.btn_pause&&(e.btns.btn_pause=null)};e.showGamePage=function(){e.btns.btn_pause&&e.drawBtns(e.btns.btn_pause)};e.createPausePage=function(){e.btns.btn_back||(e.btns.btn_back={img:n.getImage("an_3"),x:52,y:227,w:96,h:26,pressed:0},e.btns.btn_resume={img:n.getImage("an_4"),x:172,y:227,w:96,h:26,pressed:0})};e.delPausePage=function(){e.btns.btn_back&&(e.btns.btn_back=null,e.btns.btn_resume=null)};e.showPausePage=function(){e.btns.btn_back&&(e.drawBtn(e.btns.btn_back),e.drawBtn(e.btns.btn_resume))};e.createLosePage=function(){e.btns.btn_back1||(e.btns.btn_back1={img:n.getImage("an_3"),x:50,y:282,w:96,h:26,pressed:0},e.btns.btn_restart={img:n.getImage("an_2"),x:172,y:282,w:96,h:26,pressed:0})};e.delLosePage=function(){e.btns.btn_back1&&(e.btns.btn_back1=null,e.btns.btn_restart=null)};e.showLosePage=function(){e.btns.btn_back1&&(e.drawBtn(e.btns.btn_back1),e.drawBtn(e.btns.btn_restart))};var x,T,N,C,k=0,L=1,A=2,O=[[0,0,48,43],[48,0,48,43],[96,0,48,43],[144,0,48,43]],_=[[0,0,126,50],[126,0,126,50],[252,0,126,50],[378,0,126,50]],D="kill1 kill2 kill2 kill3 kill4 kill5 kill3 kill4 kill5 kill3 kill4 kill5 kill3 kill4 kill5 kill6 kill7 kill8".split(" "),P=0,H=1,B=2,j=[[0,0,48,57],[48,0,48,57],[96,0,48,57],[144,0,48,57]],F=[[0,0,89,104],[89,0,89,104],[178,0,89,104],[267,0,89,104]],I=n.getImage("beijing"),q=function(){e.ctxBuf.drawImage(n.getImage("beijing"),0,0,I.width,I.height,0,0,I.width,I.height);T.draw();x.draw();for(var t=e.enemyData.length-1;0<=t;t--)e.enemyData[t].draw();for(t=e.boomData.length-1;0<=t;t--)e.boomData[t].draw();for(t=e.protection.length-1;0<=t;t--)e.ctxBuf.drawImage(n.getImage("pp"),e.protection[t].x,e.protection[t].y);e.ctxBuf.drawImage(n.getImage("l"),0,e.buffer.height-40);e.showGamePage();R("numb",92,e.buffer.height-33,b,!0);for(t=0;t<e.inKill;t++)e.ctxBuf.drawImage(n.getImage("ym"),40*t,e.buffer.height-40-36)},R=function(t,r,i,s,o,u){var f=[0,0,0,0,0,0,0,0,0,0],l=n.getImage(t),c=l.width/10,l=l.height,h=0;if(0==s)e.ctxBuf.drawImage(t,0,0,c,l,r,i,c,l);else{for(;0!=s;)f[h]=s%10,s=parseInt(s/10),h++;if(o)for(s=h-1,o=0;o<=s;o++)e.ctxBuf.drawImage(t,f[o]*c,0,c,l,r,i,c,l),r-=(c+2)*u;else for(o=h-1;0<=o;o--)e.ctxBuf.drawImage(t,f[o]*c,0,c,l,r,i,c,l),r+=(c+2)*u}};n.touch.resize(function(){.01<Math.abs(e.scaleTmp-e.scale)&&e.initCanvas();0==window.orientation?(e.initCanvas(),n.canvas.screen.setHeight(1200),e.clue=!1):(n.canvas.screen.setHeight(window.innerHeight),e.clue=!0,e.showClue());window.scrollTo(0,-5)});e.showClue=function(){window.scrollTo(0,-5);e.ctx.fillStyle="white";e.ctx.fillRect(0,0,window.innerWidth,window.innerHeight);e.ctx.drawImage(n.getImage("clue"),(window.innerWidth-122)/2,(window.innerHeight-145)/2)};(function(){e.clue=!1;e.initCanvas();e.btns={};e.music=[];e.sound=!0;e.initMusic();if("string"==typeof n.localStorage.getItem("renzhe_bastScore")){var t=n.localStorage.getItem("renzhe_bastScore");w=parseInt(t)}r(E);i(h)})();n.run(function(){window.scrollTo(0,-5);if(e.clue)e.showClue();else{switch(y){case v:n.keyPressed("left")?i(m):n.keyPressed("right")?i(g):n.keyPressed("a")&&i(1003);break;case m:n.keyPressed("a")&&(E++,r(E));break;case g:if(n.keyPressed("a"))0==S?r(E):(E=0,n.updateScore({score:b}),n.gameFlow.over());else if(n.keyPressed("left")||n.keyPressed("right"))S=0==S?1:0;break;case 1003:n.keyPressed("a")&&(E=0,n.updateScore({score:b}),n.gameFlow.over())}switch(y){case h:e.time++;N.cycle();e.ctxBuf.drawImage(n.getImage("beijing"),0,0);N.draw();e.showMenuPage();e.showClueDialog();e.ctx.drawImage(e.buffer,0,e.offset,e.width,e.height);break;case p:e.ctxBuf.drawImage(n.getImage("beijing"),0,0,I.width,I.height,0,0,I.width,I.height);T.draw();C.cycle();C.draw();e.ctx.drawImage(e.buffer,0,e.offset,e.width,e.height);break;case v:if(x.y>x.inity)x.y-=10,x.cycle();else{b++;e.time++;T.cycle();x.cycle();if(0==e.time%e.addRole){var t=n.commandFuns.getRandom(0,0),o=n.commandFuns.getRandom(0,1),t=new u(t,o);e.enemyData.push(t)}else 0==e.time%e.addZhang?(o=n.commandFuns.getRandom(0,1),t=new u(1,o),e.enemyData.push(t)):0==e.time%e.addBird&&(o=n.commandFuns.getRandom(0,1),t=new u(2,o),e.enemyData.push(t));for(t=e.enemyData.length-1;0<=t;t--)if(e.enemyData[t].cycle(),e.enemyData[t].y>e.buffer.height+e.enemyData[t].height)e.enemyData.splice(t,1);else if(x.kill())e.enemyData[t].y>e.buffer.height-x.imgKillWH.height&&(o=new s(e.enemyData[t].x,e.enemyData[t].y),e.boomData.push(o),e.enemyData.splice(t,1));else if(n.commandFuns.collisionCheck(e.enemyData[t].x+e.enemyData[t].bodyRect[0],e.enemyData[t].y+e.enemyData[t].bodyRect[1],e.enemyData[t].bodyRect[2],e.enemyData[t].bodyRect[3],x.x+x.body[0],x.y+x.body[1],x.body[2],x.body[3]))if(x.protection)o=new s(e.enemyData[t].x,e.enemyData[t].y),e.boomData.push(o),x.protection=!1,e.enemyData[t].type!=H||x.stay!=L&&x.stay!=A||(e.inKill++,x.protection=!0),e.enemyData.splice(t,1);else switch(e.enemyData[t].type){case P:i(g);break;case H:switch(x.stay){case k:i(g);break;case L:case A:e.inKill++,o=new s(e.enemyData[t].x,e.enemyData[t].y),e.boomData.push(o),e.enemyData.splice(t,1)}break;case B:i(g)}700==b&&(e.addRole=40,e.addZhang=70,e.addBird=100);1500==b&&(e.addRole=30,e.addZhang=50,e.addBird=80);for(t=e.boomData.length-1;0<=t;t--)e.boomData[t].cycle(),e.boomData[t].isOut()&&e.boomData.splice(t,1);0==e.time%222&&(t=n.commandFuns.getRandom(100,170),e.protection.push({x:t,y:-80}));for(t=e.protection.length-1;0<=t;t--)e.protection[t].y+=10,e.protection[t].y>e.buffer.height?e.protection.splice(t,1):n.commandFuns.collisionCheck(e.protection[t].x+20,e.protection[t].y+20,40,40,x.x,x.y,x.width,x.height)&&(x.protection=!0,e.protection.splice(t,1))}q();e.ctx.drawImage(e.buffer,0,e.offset,e.width,e.height);break;case d:q();C.cycle();C.draw();e.showPausePage();e.ctx.drawImage(e.buffer,0,e.offset,e.width,e.height);break;case g:x.y+=20,q(),x.y>e.buffer.height&&(C.cycle(),C.draw()),e.showLosePage(),e.ctx.drawImage(e.buffer,0,e.offset,e.width,e.height)}}});R=function(t,r,i,s,o){var u=[0,0,0,0,0,0,0,0,0,0],f=n.getImage(t),l=f.width/10,f=f.height,c=0;if(0==s)e.ctxBuf.drawImage(n.getImage(t),0,0,l,f,r,i,l,f);else{for(;0!=s;)u[c]=s%10,s=parseInt(s/10),c++;if(o)for(s=c-1,o=0;o<=s;o++)e.ctxBuf.drawImage(n.getImage(t),u[o]*l,0,l,f,r,i,l,f),r-=l;else for(o=c-1;0<=o;o--)e.ctxBuf.drawImage(n.getImage(t),u[o]*l,0,l,f,r,i,l,f),r+=l}}})}