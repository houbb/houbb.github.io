<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç‹¼ã€ç¾Šã€è‰ æ²™ç›’æ¨¡æ‹Ÿ</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f5f5f5;
            display: flex;
            justify-content: space-between;
            margin: 0;
        }
        .left-panel {
            flex-grow: 1;
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
        }
        .sandbox {
            display: grid;
            grid-template-columns: repeat(50, 15px);
            grid-template-rows: repeat(50, 15px);
            gap: 1px;
            margin-top: 20px;
        }
        .cell {
            width: 15px;
            height: 15px;
            border: 1px solid #ccc;
            text-align: center;
            vertical-align: middle;
            font-size: 12px;
            font-family: "Segoe UI Emoji", sans-serif;
        }
        .wolf {
            color: red;
        }
        .sheep {
            color: lightgreen;
        }
        .grass {
            color: green;
        }
        .empty {
            background-color: white;
        }
        .right-panel {
            width: 250px;
            margin-top: 20px;
            padding: 20px;
            background-color: #fff;
            border: 1px solid #ccc;
            font-size: 16px;
            text-align: left;
        }
        .right-panel div {
            margin: 10px 0;
        }
    </style>
</head>
<body>

    <div class="left-panel">
        <div class="sandbox" id="sandbox"></div>
    </div>
    
    <div class="right-panel">
        <h3>ç»Ÿè®¡ä¿¡æ¯</h3>
        <div>å½“å‰å¤©æ°”: <span id="weather"></span></div>
        <div>å½“å‰å­£èŠ‚: <span id="season"></span></div>
        <div>æ—¶é—´: <span id="time"></span></div>
        <div>ç‹¼çš„æ•°é‡: <span id="wolfCount"></span></div>
        <div>ç¾Šçš„æ•°é‡: <span id="sheepCount"></span></div>
        <div>è‰çš„æ•°é‡: <span id="grassCount"></span></div>
        <div>æ¨¡æ‹Ÿæ—¶é—´: <span id="simTime"></span> ç§’</div>
    </div>

    <button onclick="startSimulation()">å¼€å§‹æ¨¡æ‹Ÿ</button>

    <script>
        const sandboxSize = 50;
        const seasons = ['æ˜¥', 'å¤', 'ç§‹', 'å†¬'];
        let grid = [];
        let animals = {
            wolf: [],
            sheep: []
        };
        let grass = [];
        let seasonIndex = 0;
        let weather = 'æ™´å¤©';
        let simTime = 0;
        let simInterval;
        
        function createSandbox() {
            const sandbox = document.getElementById('sandbox');
            for (let i = 0; i < sandboxSize; i++) {
                const row = [];
                for (let j = 0; j < sandboxSize; j++) {
                    const cell = document.createElement('div');
                    cell.classList.add('cell');
                    cell.dataset.row = i;
                    cell.dataset.col = j;
                    sandbox.appendChild(cell);
                    row.push(cell);
                }
                grid.push(row);
            }
        }

        function randomPosition() {
            return {
                row: Math.floor(Math.random() * sandboxSize),
                col: Math.floor(Math.random() * sandboxSize)
            };
        }

        function initializeEntities() {
            // åˆå§‹åŒ–è‰
            for (let i = 0; i < 500; i++) {
                const pos = randomPosition();
                if (!grass.some(g => g.row === pos.row && g.col === pos.col)) {
                    grass.push(pos);
                    grid[pos.row][pos.col].innerText = 'ğŸŒ¿';
                }
            }
            // åˆå§‹åŒ–ç¾Š
            for (let i = 0; i < 20; i++) {
                const pos = randomPosition();
                animals.sheep.push(pos);
                grid[pos.row][pos.col].innerText = 'ğŸ‘';
            }
            // åˆå§‹åŒ–ç‹¼
            for (let i = 0; i < 10; i++) {
                const pos = randomPosition();
                animals.wolf.push(pos);
                grid[pos.row][pos.col].innerText = 'ğŸº';
            }
        }

        function nextSeason() {
            seasonIndex = (seasonIndex + 1) % 4;
            updateWeather();
        }

        function updateWeather() {
            // ç®€å•çš„å¤©æ°”å˜åŒ–é€»è¾‘
            const weatherConditions = ['æ™´å¤©', 'é›¨å¤©', 'æš´é£é›ª'];
            weather = weatherConditions[Math.floor(Math.random() * 3)];
            document.getElementById('weather').textContent = weather;
        }

        function moveAnimals() {
			// ç§»åŠ¨ç‹¼
			animals.wolf.forEach(wolf => {
				// è®¡ç®—æ–°ä½ç½®
				const direction = Math.random() > 0.5 ? 1 : -1;
				const newRow = wolf.row + direction * (Math.random() > 0.5 ? 1 : 0);
				const newCol = wolf.col + direction * (Math.random() > 0.5 ? 1 : 0);

				// åˆ¤æ–­æ–°ä½ç½®æ˜¯å¦è¶Šç•Œ
				if (newRow >= 0 && newRow < sandboxSize && newCol >= 0 && newCol < sandboxSize) {
					// æ¸…ç©ºåŸä½ç½®
					grid[wolf.row][wolf.col].innerText = ' ';

					// æ›´æ–°ç‹¼çš„ä½ç½®
					wolf.row = newRow;
					wolf.col = newCol;

					const cell = grid[wolf.row][wolf.col];

					// ç‹¼ç¢°åˆ°ç¾Šï¼Œåƒæ‰ç¾Š
					if (cell.innerText === 'ğŸ‘') {
						animals.sheep = animals.sheep.filter(s => s.row !== wolf.row || s.col !== wolf.col);
						cell.innerText = 'ğŸº';
						// ç¾Šçš„æ•°é‡å‡å°‘
						sheepCount--;
					} else {
						cell.innerText = 'ğŸº';
					}
				}
			});

			// ç§»åŠ¨ç¾Š
			animals.sheep.forEach(sheep => {
				// è®¡ç®—æ–°ä½ç½®
				const direction = Math.random() > 0.5 ? 1 : -1;
				const newRow = sheep.row + direction * (Math.random() > 0.5 ? 1 : 0);
				const newCol = sheep.col + direction * (Math.random() > 0.5 ? 1 : 0);

				// åˆ¤æ–­æ–°ä½ç½®æ˜¯å¦è¶Šç•Œ
				if (newRow >= 0 && newRow < sandboxSize && newCol >= 0 && newCol < sandboxSize) {
					// æ¸…ç©ºåŸä½ç½®
					grid[sheep.row][sheep.col].innerText = ' ';

					// æ›´æ–°ç¾Šçš„ä½ç½®
					sheep.row = newRow;
					sheep.col = newCol;

					const cell = grid[sheep.row][sheep.col];

					// ç¾Šç¢°åˆ°è‰ï¼Œåƒæ‰è‰
					if (cell.innerText === 'ğŸŒ¿') {
						grass = grass.filter(g => g.row !== sheep.row || g.col !== sheep.col);
						cell.innerText = 'ğŸ‘';
						// è‰çš„æ•°é‡å‡å°‘
						grassCount--;
					} else {
						cell.innerText = 'ğŸ‘';
					}
				}
			});
		}


        function growGrass() {
            if (weather === 'æ™´å¤©' && seasonIndex === 0) {
                // æ˜¥å¤©æ™´å¤©è‰å¿«é€Ÿç”Ÿé•¿
                if (grass.length < 1000) {
                    const pos = randomPosition();
                    if (!grass.some(g => g.row === pos.row && g.col === pos.col)) {
                        grass.push(pos);
                        grid[pos.row][pos.col].innerText = 'ğŸŒ¿';
                    }
                }
            }
        }

        function updateStats() {
            document.getElementById('season').textContent = seasons[seasonIndex];
            document.getElementById('time').textContent = new Date().toLocaleTimeString();
            document.getElementById('wolfCount').textContent = animals.wolf.length;
            document.getElementById('sheepCount').textContent = animals.sheep.length;
            document.getElementById('grassCount').textContent = grass.length;
            document.getElementById('simTime').textContent = simTime;
        }

		function resetInfo() {
			grid = [];
			animals = {
				wolf: [],
				sheep: []
			};
			grass = [];
			seasonIndex = 0;
			weather = 'æ™´å¤©';
			simTime = 0;
		}
		
		createSandbox();
        initializeEntities();
			
        function startSimulation() {
            simInterval = setInterval(() => {
                moveAnimals();
                growGrass();
                nextSeason();
                simTime++;
                updateStats();
            }, 1000); // ç°å® 1 åˆ†é’Ÿå¯¹åº”æ²™ç›’ 1 å°æ—¶
        }
    </script>

</body>
</html>