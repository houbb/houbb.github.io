"use strict";(self["webpackChunkidrag"]=self["webpackChunkidrag"]||[]).push([[937],{937:function(e,t,n){n.r(t),n.d(t,{default:function(){return F}});var i=function(){var e=this,t=e._self._c;return"edit"==e.editMode?t("div",{staticClass:"v-text",on:{keydown:e.handleKeydown,keyup:e.handleKeyup}},[t("div",{ref:"text",class:{"can-edit":e.canEdit},style:{verticalAlign:e.element.style.verticalAlign},attrs:{contenteditable:e.canEdit,tabindex:"0"},domProps:{innerHTML:e._s(e.element.propValue)},on:{dblclick:e.setEdit,paste:e.clearStyle,mousedown:e.handleMousedown,blur:e.handleBlur,input:e.handleInput}})]):t("div",{staticClass:"v-text preview"},[t("div",{style:{verticalAlign:e.element.style.verticalAlign},domProps:{innerHTML:e._s(e.element.propValue)}})])},o=[],l=(n(6699),n(629)),a=n(8798),s=n(4003);const c=86,r=67,d=88,u=89,p=90,h=71,m=66,f=76,k=85,y=83,g=80,v=68,C=46,Z=69,b=[66,67,68,69,71,76,80,83,85,86,88,89,90],w={[c]:x,[u]:M,[p]:T,[y]:L,[g]:K,[Z]:V};function $(){a.Z.commit("copy")}function x(){a.Z.commit("paste")}function E(){a.Z.commit("cut")}function M(){a.Z.commit("redo")}function T(){a.Z.commit("undo")}function D(){a.Z.state.areaData.components.length&&a.Z.commit("compose")}function H(){const e=a.Z.state.curComponent;e&&!e.isLock&&"Group"==e.component&&a.Z.commit("decompose")}function L(){s.Z.$emit("save")}function K(){s.Z.$emit("preview")}function S(){a.Z.state.curComponent&&a.Z.commit("deleteComponent")}function V(){s.Z.$emit("clearCanvas")}function P(){a.Z.commit("lock")}function j(){a.Z.commit("unlock")}var A,O,R={props:{linkage:{type:Object,default:()=>{}},element:{type:Object,default:()=>{}}},created(){this.linkage?.data?.length&&(s.Z.$on("v-click",this.onClick),s.Z.$on("v-hover",this.onHover))},mounted(){const{data:e,duration:t}=this.linkage||{};e?.length&&(this.$el.style.transition=`all ${t}s`)},beforeDestroy(){this.linkage?.data?.length&&(s.Z.$off("v-click",this.onClick),s.Z.$off("v-hover",this.onHover))},methods:{changeStyle(e=[]){e.forEach((e=>{e.style.forEach((e=>{e.key&&(this.element.style[e.key]=e.value)}))}))},onClick(e){const t=this.linkage.data.filter((t=>t.id===e&&"v-click"===t.event));this.changeStyle(t)},onHover(e){const t=this.linkage.data.filter((t=>t.id===e&&"v-hover"===t.event));this.changeStyle(t)}}},_=R,q=n(1001),B=(0,q.Z)(_,A,O,!1,null,null,null),I=B.exports,G={extends:I,props:{propValue:{type:String,required:!0,default:""},request:{type:Object,default:()=>{}},element:{type:Object,default:()=>{}},linkage:{type:Object,default:()=>{}}},data(){return{canEdit:!1,ctrlKey:17,isCtrlDown:!1,cancelRequest:null}},computed:{...(0,l.rn)(["editMode","curComponent"])},created(){s.Z.$on("componentClick",this.onComponentClick)},beforeDestroy(){s.Z.$off("componentClick",this.onComponentClick)},methods:{onComponentClick(){this.curComponent.id!==this.element.id&&(this.canEdit=!1)},handleInput(e){this.$emit("input",this.element,e.target.innerHTML)},handleKeydown(e){this.canEdit&&e.stopPropagation(),e.keyCode==this.ctrlKey?this.isCtrlDown=!0:(this.isCtrlDown&&this.canEdit&&b.includes(e.keyCode)||46==e.keyCode)&&e.stopPropagation()},handleKeyup(e){this.canEdit&&e.stopPropagation(),e.keyCode==this.ctrlKey&&(this.isCtrlDown=!1)},handleMousedown(e){this.canEdit&&e.stopPropagation()},clearStyle(e){e.preventDefault();const t=e.clipboardData,n=t.getData("text/plain")||"";""!==n&&document.execCommand("insertText",!1,n),this.$emit("input",this.element,e.target.innerHTML)},handleBlur(e){this.element.propValue=e.target.innerHTML||"&nbsp;";const t=e.target.innerHTML;""!==t?this.element.propValue=e.target.innerHTML:(this.element.propValue="",this.$nextTick((()=>{this.element.propValue="&nbsp;"}))),this.canEdit=!1},setEdit(){this.element.isLock||(this.canEdit=!0,this.selectText(this.$refs.text))},selectText(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}}},N=G,z=(0,q.Z)(N,i,o,!1,null,"71eec6ee",null),F=z.exports}}]);
//# sourceMappingURL=937.222cb434.js.map