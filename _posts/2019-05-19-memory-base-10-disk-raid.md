---
layout: post
title: Memory 内存知识-10-Disk Raid
date:  2019-5-10 11:08:59 +0800
categories: [Memory]
tags: [memory, cache, sh]
published: true
---

# 磁盘基本知识

磁盘大致由盘片、磁头、步进电机等几部分组成组成。

盘面：硬盘一般含有一个或多个盘片，一个盘片包含两个盘面。

磁道：每个盘面被划成多个狭窄的同心圆环，这样的圆环叫做磁道。

扇区：每个磁道的每段圆弧叫做一个扇区，是读写的最小单位。

柱面：所有盘面上的同一磁道，在竖直方向构成一个圆柱，称为柱面。

读写过程：硬盘读取数据时，磁头先移动到读取扇区所在磁道的上方，这个过程耗时叫做磁盘寻道时间，平均时间为10ms。之后，通过盘片的旋转，使得扇区转到磁头的下方，这个过程耗时叫做旋转延迟时间，对于7200转/min的硬盘转一周为60*1000/7200=8.33ms，平均旋转延迟为4.17ms（半圈）。

# RAID基本知识

RAID（Redundant Array of Independent Disks），即由独立的磁盘组成的具有冗余特性的阵列。

其基本思想就是把多个相对便宜的硬盘组合起来，成为一个硬盘阵列组，使性能达到甚至超过一个价格昂贵、 容量巨大的硬盘。

RAID 0，条带化存储，容量增加，并行化，但无冗余，容易单点故障。

RAID 1，镜像存储，写入速率慢，读取速率快，有冗余备份，优点是高可靠、高可用，缺点是高花费。

RAID 2，RAID 0的改进版，使用汉明码进行检测和纠错，适用于连续IO、大块IO（如视频流）。

RAID 3，RAID 3和RAID 2的思路比较相似，使用奇偶校验进行错误检测和纠错，但校验盘单点故障。

RAID 4，RAID 4和RAID 3思路一样，只不过是使用BLOCK进行存储。

RAID 5，校验信息交叉的存储在所有数据盘上，高冗余，高数据传输率，实现复杂。

RAID 6，相比RAID5增加块内的校验，允许同时坏2块硬盘而不丢失数据。

RAID 01，先做条带（0），再做镜像（1）。读写速度快，数据保护能力强，空间利用率50%。

RAID 10，先做镜像（1），再做条带（0）。

# 存储方式

根据网上的资料和理解，用Visio整理了一张图对比了下几种方式：

![image](https://user-images.githubusercontent.com/18375710/61855146-19391200-aef2-11e9-8f65-ef9d50a962c8.png)

DAS全称为Direct Attached Storage，即服务器直连存储。如图所示，文件系统直接通过RAID完成对硬件访问。优点是操作简便，经济，缺点是分散式存储，不可集中管理。

NAS全称为Network Attached Storage，即网络存储服务。如图所示，文件系统通过网络暴露出来给应用服务。优点是结构简单。配置使用管理非常方便，可实现跨平台的数据共享。缺点是需要占用网络资源、应用局限性大。

SAN全称为Storage Aera Network，即存储区域网络，如图所示，RAID接口通过网络暴露出来。优点是扩展性强，集中管理，缺点是成本较高，管理维护难度大。

# IP SAN 与 FC SAN

FC SAN 指基于光纤通道（Fiber Channel）的存储区域网，在 FC SAN 中存在两张网，一张面向应用的网（IP网），另一张中则是存储网（FC网）。

而IP SAN的出现则是为了寻求一种新的方式，用与应用网相同的体系架构来构造存储网，使用通用的IP网络及设备。

FC SAN性能好，价格高，但与主流的IP网络异构。适用于关键应用的几种存储、备份及容灾。

IP SAN则由于以太网MTU（1518字节）的限制，性能稍差，但基于通用的IP协议。适用于异地间的数据交换、备份容灾，非关键应用的集中存储。

# LVM基本知识

LVM的全称是Logical Volume Manager，逻辑卷轴管理，主要解决的问题是，弹性调整文件系统的容量。

![image](https://user-images.githubusercontent.com/18375710/61855383-8c428880-aef2-11e9-9a8d-3563407b2597.png)

与传统的磁盘与分区相比，LVM为计算机提供了更高层次的存储，通过在磁盘分区和文件系统之间增加一个逻辑层，提供一个抽象的逻辑盘卷。

# 参考资料

[存储知识学习](http://yikun.github.io/2016/02/03/%E5%AD%98%E5%82%A8%E7%9F%A5%E8%AF%86%E5%AD%A6%E4%B9%A0/)

* any list
{:toc}