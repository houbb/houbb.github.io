---
layout: post
title: 性能压测优化的一些最佳实践技巧
date: 2025-3-7 19:49:19 +0800
categories: [Performance]
tags: [perf, perfomance, best-practise, sh]
published: true
---


# 一些技巧


网络传输：压缩+解压

解耦：可以使用 Kafka/rocket 进行异步解耦

数据库交互：无论是 mysql/vm/neo4j 等等，学会使用批量入库操作。避免单次过大

异步线程池：可以考虑采用多线程处理提升并发性能，但是会提升系统的复杂度。

索引

# chat

## 软件性能优化，有哪些常见的技巧与最佳实践



软件性能优化是一个涵盖从系统设计到代码实现、再到运行环境调优的全方位过程。以下是结合多领域资料总结的常见技巧与最佳实践，涵盖不同层级和场景的优化策略：

---

### 一、基本原则与核心思想
1. **全生命周期优化**：性能优化应贯穿软件开发的整个生命周期，而非仅在后期补救。设计阶段需考虑架构扩展性、资源利用率及算法复杂度。
2. **数据驱动决策**：通过性能分析工具（如Profiler、APM）持续监控关键指标（如CPU/内存占用、响应时间），定位瓶颈而非盲目优化。
3. **平衡与取舍**：优化需权衡时间与空间、开发效率与性能收益，避免过度优化导致代码可维护性下降。
4. **团队协作文化**：性能是团队共同责任，需建立性能测试自动化流程和性能回归机制。

---

### 二、代码级优化技巧
#### 1. **算法与数据结构优化**
- **时间复杂度优化**：优先选择O(1)、O(logn)的算法，如哈希表查询、二分查找替代线性搜索。
- **数据结构适配场景**：
  - 频繁插入/删除：链表优于数组。
  - 高频查找：哈希表或平衡二叉搜索树（如红黑树）。
  - 范围查询：B树或跳表。
- **循环与条件优化**：减少嵌套循环、提取公共子表达式、循环展开（Loop Unrolling）。

#### 2. **内存管理优化**
- **对象池技术**：预分配对象并复用，减少GC压力（如Unity中的ObjectPoolMgr）。
- **避免内存泄漏**：使用工具（如LeakCanary、Valgrind）检测未释放资源，尤其是闭包、监听器。
- **缓存友好性**：优化数据布局（如结构体字段对齐）、顺序访问数组以提高缓存命中率。

#### 3. **运算与编译器优化**
- **位运算替代乘除**：如用移位代替乘2操作。
- **编译器标志启用**：使用`-O3`（GCC/Clang）或`/Ox`（MSVC）开启高级优化。
- **内联函数**：减少函数调用开销，但需避免代码膨胀。

---

### 三、系统级优化策略
#### 1. **I/O操作优化**
- **异步与非阻塞I/O**：使用epoll（Linux）、kqueue（BSD）或异步库（如Node.js的libuv）减少等待时间。
- **批量处理与缓冲**：合并小文件读写（如数据库事务批量提交）、使用BufferedInputStream减少系统调用次数。
- **零拷贝技术**：如Linux的sendfile、splice，减少数据在用户态与内核态间的复制。

#### 2. **并发与多线程优化**
- **线程池管理**：避免频繁创建/销毁线程，合理设置核心线程数与队列策略（如Java的ThreadPoolExecutor）。
- **锁优化**：
  - 无锁数据结构：如CAS（Compare-And-Swap）实现的队列。
  - 细粒度锁：拆分全局锁为分段锁（如ConcurrentHashMap）。
- **并行化计算**：利用SIMD指令（如AVX）、OpenMP或GPU加速计算密集型任务。

#### 3. **数据库性能优化**
- **索引策略**：
  - 覆盖索引（Include所有查询字段）减少回表。
  - 避免冗余索引，定期使用EXPLAIN分析执行计划。
- **查询优化**：
  - 分页查询使用游标而非LIMIT OFFSET。
  - 避免SELECT *，减少数据传输量。
- **缓存机制**：本地缓存（如Guava Cache）与分布式缓存（Redis）结合，设置合理过期时间。

---

### 四、应用场景差异化策略
#### 1. **Web应用优化**
- **前端优化**：
  - 图片压缩（WebP格式）、懒加载（LazyLoad）。
  - 合并CSS/JS文件，使用CDN加速静态资源。
- **后端优化**：HTTP/2多路复用、服务端渲染（SSR）减少首屏加载时间。

#### 2. **移动端优化**
- **内存敏感处理**：避免大图直接加载，使用缩略图或按需解码。
- **网络优化**：协议优化（QUIC替代TCP）、请求合并与数据压缩（Protocol Buffers）。
- **电量管理**：减少唤醒锁（WakeLock）使用，后台任务批处理。

#### 3. **嵌入式系统优化**
- **资源受限优化**：静态内存分配替代动态分配，禁用异常处理（RTTI）。
- **实时性保障**：中断服务例程（ISR）精简、优先级调度策略优化。

---

### 五、工具与框架支持
1. **性能分析工具**：
   - 前端：Chrome DevTools、Lighthouse。
   - 后端：JProfiler、VisualVM、Perf。
   - 移动端：Xcode Instruments、Android Profiler。
2. **框架级优化**：
   - 数据库ORM框架启用查询缓存（如Hibernate二级缓存）。
   - 使用异步框架（如Netty、Vert.x）提升I/O吞吐量。

---

### 六、新兴技术融合
- **AI驱动的自动优化**：利用机器学习预测资源需求，动态调整线程池大小或缓存策略。
- **硬件加速**：FPGA/ASIC实现特定算法（如加密、图像处理）的硬件加速。

---

### 总结
性能优化需结合具体场景，从架构设计到代码实现层层递进。关键在于建立可度量的性能基线，通过工具定位瓶颈，再针对性地应用优化策略。同时，需警惕优化带来的复杂度上升，始终以用户体验和长期可维护性为核心目标。

# 参考资料

* any list
{:toc}