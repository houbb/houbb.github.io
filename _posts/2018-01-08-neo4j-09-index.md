---
layout: post
title:  Neo4j-08-图数据库 neo4j index 索引创建
date:  2018-1-8 14:18:33 +0800
categories: [SQL]
tags: [nosql, neo4j]
published: true
---

# Q1-neo4j 如何给关系的属性添加索引

在Neo4j图数据库中，可以给关系的属性添加索引，以便快速检索和查询。要给关系的属性添加索引，你可以按照以下步骤进行操作：

### 1. 创建索引
首先，你需要创建一个关系属性的索引。你可以使用以下的Cypher查询语句来创建一个关系属性的索引：

```cypher
CREATE INDEX ON :RelationshipType(propertyKey);
```

在上述查询中，`RelationshipType` 是关系的类型，`propertyKey` 是你想要添加索引的属性。

### 2. 查看索引
如果你想查看已经存在的索引，可以使用以下的Cypher查询：

```cypher
:schema
```

这个命令会显示所有的索引，包括节点和关系的索引。

### 3. 使用索引进行查询
一旦你创建了索引，Neo4j会在查询时使用它来加速检索。你可以在Cypher查询中使用关系属性的索引来执行快速查询。例如：

```cypher
MATCH (startNode)-[r:RelationshipType]->(endNode)
WHERE r.propertyKey = value
RETURN startNode, r, endNode;
```

在上述查询中，`RelationshipType` 是关系的类型，`propertyKey` 是你添加索引的属性，`value` 是你想要查询的属性值。

请注意，索引的性能取决于数据的分布和查询的复杂性。合适地使用索引可以显著提高查询性能，但是过度使用索引可能会导致性能下降。在设计和使用索引时，请根据具体的需求和数据特点进行权衡和优化。

# Q2-上面的报错

```
报错 Invalid create index syntax, use `CREATE INDEX FOR ...` instead. (line 1, column 1 (offset: 0))
"create index on :METHOD_CALLS(id)"
 ^
```

在Neo4j 4.0 版本之后，创建索引的语法发生了变化。在新版本中，你需要使用 `CREATE INDEX FOR` 语法来创建索引。以下是正确的创建索引的方法：

```cypher
CREATE INDEX FOR (n:METHOD_CALLS) ON (n.id);
```

在上述查询中，`METHOD_CALLS` 是节点的标签，`id` 是你想要添加索引的属性。这个查询会在 `METHOD_CALLS` 节点的 `id` 属性上创建索引。

请确保你的Neo4j数据库版本符合这个语法要求。

如果你的版本较旧，可能需要考虑升级到支持新语法的版本。

实测成功。


# Q3-如何查看 neo4j 的版本？

要查看Neo4j数据库的版本，你可以使用Neo4j的命令行工具或者在Neo4j的浏览器中执行Cypher查询来获取版本信息。

### 使用Neo4j的命令行工具：

如果你使用的是Neo4j的命令行工具（例如在Unix/Linux系统上的终端或者Windows系统上的命令提示符），可以使用以下命令来获取Neo4j的版本信息：

```bash
neo4j --version
```

这个命令会显示Neo4j的版本号以及其他相关信息。

### 使用Neo4j的浏览器：

1. 打开Neo4j的浏览器界面。
2. 在浏览器中，点击右上角的设置按钮（齿轮图标）。
3. 在弹出的菜单中，选择"System Information"（系统信息）。
4. 在系统信息页面中，你可以看到Neo4j数据库的版本信息。

请注意，确保你有适当的权限来执行这些操作，特别是在生产环境中进行系统信息的查看。

# 参考资料

https://www.w3cschool.cn/neo4j/neo4j_cql_relationship_basics.html

https://www.w3cschool.cn/neo4j/neo4j_directional_relationships.html

* any list
{:toc}

