---
layout: post
title: 权限体系之-11-passport 登录安全之 weak-password 弱口令
date: 2025-11-20 14:12:33 +0800
categories: [plateform]
tags: [plateform, sh]
published: true
---



# 弱口令是什么？

**弱口令，几乎是所有系统沦陷的第一入口。**

我们用“工程视角 + 安全实战”的方式，彻底讲清楚三件事：

1. 什么是弱口令（不是只说“123456”这么简单）
2. 弱口令为什么这么致命
3. 如何系统性避免 + 安全加固方案（可直接落地）

---

# 一、什么是弱口令？不是“简单密码”那么肤浅

弱口令的本质定义是：

> 容易被猜中、推断、爆破、社工、字典攻击命中的密码。

它包括但不限于：

### 典型弱口令类型

#### 1. 过于简单

* 123456
* 111111
* qwerty
* admin

#### 2. 规则可预测

* Password123
* Abc@123
* test2024

#### 3. 与个人信息高度相关

* 手机号
* 生日：19900101
* 名字拼音：zhangsan

#### 4. 系统默认口令

* admin/admin
* root/root
* user/123456

#### 5. 复用密码

* 在多个系统中使用同一密码

✅ 所以，“弱口令”不是某几个密码，而是一类可推断、可批量攻击的密码模式。

---

# 二、弱口令攻击通常是怎么发生的？

真实攻击路径往往是这样的：

```
扫描系统入口
 -> 尝试默认账号
 -> 字典爆破
 -> 猜测规则密码
 -> 登录成功
```

常见攻击方式：

| 攻击方式 | 描述          |
| ---- | ----------- |
| 字典攻击 | 使用弱口令字典批量尝试 |
| 暴力破解 | 穷举组合        |
| 社工攻击 | 利用个人公开信息推测  |
| 撞库攻击 | 其他系统泄露的密码复用 |

⚠️ 很多系统并不是“被黑”，而是：
**管理员账号密码是 admin123。**

---

# 三、弱口令的危害不仅是“被登录”

弱口令的连锁反应往往包括：

* 数据泄露
* 权限提升
* 后门植入
* 横向渗透
* 服务器沦陷
* 数据库被脱库

很多安全事故的起点只有一句话：

> 密码太简单。

---

# 四、如何系统性避免弱口令？（核心重点）

靠“提醒用户别用简单密码”是没用的，必须制度化 + 系统化。

## ✅ 1. 强密码策略（Password Policy）

这是基础但必须：

推荐规则：

* 长度 ≥ 12 位（最低也应 8 位）
* 至少包含：

  * 大写字母
  * 小写字母
  * 数字
  * 特殊字符
* 禁止连续字符：

  * 123456
  * abcdef

示例规则：

```
密码规则：
- 8~20位
- 包含数字、字母、特殊字符
- 禁止与用户名相同
- 禁止连号
```

---

## ✅ 2. 弱口令字典检测

系统必须内置弱口令库，例如过滤：

* 常见弱口令列表（Top 10000）
* 常见规则变种
* 默认系统密码

当用户设置密码时：

```
if (password in weakPasswordList) {
  reject
}
```

这一步非常关键，是很多系统没有做的。

---

## ✅ 3. 密码强度实时提示

不要只拒绝，而要引导：

UI 提示：

* 密码强度：弱 / 中 / 强
* 实时校验条
* 建议提示（例如：增加特殊字符）

用户体验 + 安全兼顾。

---

## ✅ 4. 登录保护机制（防爆破）

配置安全限制：

* 登录失败次数限制
  例如：

  * 5 次失败锁定 10 分钟
* 验证码机制
* 滑块验证
* IP 限流

建议配置示例：

```
连续失败 5 次 -> 锁定 15 分钟
同 IP 每分钟最大 10 次尝试
```

---

## ✅ 5. 禁止密码复用策略

企业级系统建议：

* 最近 N 次密码不可重复
* 密码历史记录不可重复（如最近 5 次）

这样可以防止：
用户今天改为 A，明天又改回原密码。

---

## ✅ 6. 强制周期更新策略

高安全系统推荐：

* 90 天强制修改密码
* 修改时必须不同于历史密码

适合：
运维后台 / 管理系统 / 财务系统。

---

## ✅ 7. 使用加密存储（不是明文）

密码存储原则：

❌ 明文保存
❌ 可逆加密
✅ 单向 Hash + Salt

推荐：

* bcrypt
* PBKDF2
* Argon2

存储结构：

```
password_hash: $2a$10$asasdasd...
salt: randomString
```

---

# 五、可落地的“弱口令防护体系”设计

推荐从这 6 层建设：

```
密码输入层
 → 规则校验
 → 弱口令检测
 → 强度评估
 → 安全存储
 → 登录防爆破
 → 审计监控
```

---

# 六、Passport 中的弱口令防护完整策略（推荐）

可直接用于你的 Passport 平台：

### ✅ 密码设置阶段

* 强度校验
* 弱口令字典过滤
* 用户信息匹配过滤

### ✅ 登录阶段

* 错误次数限制
* 验证码
* IP 风控
* 行为识别

### ✅ 运维阶段

* 定期扫描弱口令用户
* 强制修改提醒
* 安全报表预警

---

# 七、可直接落地的配置建议

推荐默认安全策略：

| 项目    | 推荐值   |
| ----- | ----- |
| 最小长度  | 10 位  |
| 错误锁定  | 5 次   |
| 锁定时间  | 15 分钟 |
| 密码有效期 | 90 天  |
| 禁止重用  | 5 次以内 |
| 强度级别  | 中等以上  |

---

# 八、总结：弱口令防护的核心理念

不是靠用户自觉，而是靠系统约束。

真正有效的策略只有三条：

1. ▸ 系统强制，而不是提醒
2. ▸ 从注册到登录全流程控制
3. ▸ 安全策略可配置 + 可审计

---

# 终极总结一句话

> 弱口令不是用户问题，而是系统设计问题。

一个真正成熟的 Passport 系统，必须对弱口令实现：

* 主动发现
* 自动拦截
* 强制纠正
* 持续监控

---

如果你愿意，我可以继续帮你输出更落地内容：

✅ 弱口令检测算法设计（Java示例）
✅ Passport 密码规则配置模型
✅ 密码强度评估算法
✅ 安全审计表结构设计
✅ 登录风控策略规则引擎方案

* any list
{:toc}