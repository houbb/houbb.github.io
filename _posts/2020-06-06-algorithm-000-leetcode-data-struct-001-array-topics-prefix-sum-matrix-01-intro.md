---
layout: post
title:  äºŒç»´å‰ç¼€å’Œ Prefix Sum Matrix-01-åŸºæœ¬æ¦‚å¿µ
date:  2020-6-8 15:13:08 +0800
categories: [Algorithm]
tags: [algorithm, prefix-sum, prefix-sum-matrix, matrix, leetcode]
published: true
---

# å¼€æºåœ°å€

ä¸ºäº†ä¾¿äºå¤§å®¶å­¦ä¹ ï¼Œæ‰€æœ‰å®ç°å‡å·²å¼€æºã€‚æ¬¢è¿ fork + star~

> [https://github.com/houbb/leetcode](https://github.com/houbb/leetcode)


# äºŒç»´å‰ç¼€å’Œ

## æ˜¯ä»€ä¹ˆï¼Ÿ

äºŒç»´å‰ç¼€å’Œï¼ˆ`prefixSum[i][j]`ï¼‰æ˜¯æŒ‡ï¼šä»åŸçŸ©é˜µçš„å·¦ä¸Šè§’ `(0, 0)` åˆ°ä½ç½® `(i - 1, j - 1)` çš„**çŸ©å½¢åŒºåŸŸå†…æ‰€æœ‰å…ƒç´ çš„æ€»å’Œ**ã€‚

æ³¨æ„æ˜¯**ä»å·¦ä¸Šè§’ (0,0) å¼€å§‹**ï¼ŒåŒ…æ‹¬è¾¹ç•Œï¼Œä¸åŒ…æ‹¬ä¸‹æ ‡ `i` å’Œ `j` æœ¬èº«ï¼ˆè¿™æ˜¯ä¸ºäº†æ–¹ä¾¿åŠ å‡è¿ç®—ï¼Œç±»ä¼¼ä¸€ç»´å‰ç¼€å’Œæ•°ç»„å¤šå¼€ä¸€ä½ï¼‰ã€‚

## å‰ç¼€å’Œæ•°ç»„çš„æ„é€ æ–¹æ³•

è®¾åŸçŸ©é˜µä¸º `matrix[m][n]`ï¼Œæˆ‘ä»¬æ„é€ ä¸€ä¸ªå¤§å°ä¸º `(m + 1) Ã— (n + 1)` çš„å‰ç¼€å’ŒçŸ©é˜µ `prefix[m+1][n+1]`ï¼Œåˆå§‹åŒ–å…¨ä¸º 0ã€‚

âœ… çŠ¶æ€å®šä¹‰ï¼š

prefix[i+1][j+1] è¡¨ç¤º matrix ä¸­ä» (0,0) åˆ° (i,j) è¿™ä¸ªçŸ©å½¢çš„å…ƒç´ å’Œã€‚

âœ… çŠ¶æ€è½¬ç§»å…¬å¼ï¼š

```java
prefix[i+1][j+1] = prefix[i+1][j] + prefix[i][j+1] - prefix[i][j] + matrix[i][j]
```

æ¯ä¸ªéƒ¨åˆ†çš„è§£é‡Šï¼š

```
prefix[i+1][j]ï¼šè¡¨ç¤ºä» (0,0) åˆ° (i, j-1) çš„å­çŸ©é˜µå’Œï¼Œä¹Ÿå°±æ˜¯å½“å‰è¡Œçš„å·¦è¾¹éƒ¨åˆ†ï¼ˆä¸åŒ…æ‹¬å½“å‰ä½ç½®å…ƒç´ ï¼‰ã€‚
prefix[i][j+1]ï¼šè¡¨ç¤ºä» (0,0) åˆ° (i-1, j) çš„å­çŸ©é˜µå’Œï¼Œä¹Ÿå°±æ˜¯å½“å‰åˆ—çš„ä¸Šé¢éƒ¨åˆ†ï¼ˆä¸åŒ…æ‹¬å½“å‰ä½ç½®å…ƒç´ ï¼‰ã€‚
prefix[i][j]ï¼šè¡¨ç¤ºä» (0,0) åˆ° (i-1, j-1) çš„å­çŸ©é˜µå’Œï¼Œè¿™æ˜¯ä¸Šé¢ä¸¤éƒ¨åˆ†é‡å çš„åŒºåŸŸã€‚
matrix[i][j]ï¼šå½“å‰å•å…ƒæ ¼çš„å€¼ã€‚
```

## ğŸ” å¦‚ä½•æŸ¥è¯¢ä»»æ„å­çŸ©å½¢å’Œï¼Ÿ

æŸ¥è¯¢ `(row1, col1)` åˆ° `(row2, col2)` çš„å­çŸ©é˜µæ€»å’Œï¼š

```java
// å› ä¸º prefix å¤šäº†ä¸€è¡Œä¸€åˆ—ï¼Œæ‰€ä»¥éƒ½è¦ +1
sum = prefix[row2+1][col2+1] 
    - prefix[row1][col2+1]
    - prefix[row2+1][col1] 
    + prefix[row1][col1];
```

è§£é‡Šï¼š

* åŒ…æ‹¬äº† (0,0)-(row2,col2) ä¹‹é—´æ‰€æœ‰å€¼ï¼›
* å‡å»ä¸Šé¢é‚£ä¸€å— (0,0)-(row1-1,col2)ï¼›
* å‡å»å·¦è¾¹é‚£ä¸€å— (0,0)-(row2,col1-1)ï¼›
* å¤šå‡äº†å·¦ä¸Šè§’çš„ (0,0)-(row1-1,col1-1)ï¼Œæ‰€ä»¥åŠ å›æ¥ã€‚

### ä¸€ä¸ªç›´è§‚çš„ä¾‹å­

å‡è®¾ä¸€ä¸ª 5*5 çš„çŸ©é˜µï¼Œå¦‚æœæ±‚ (2,2)->(3,3) çš„ç´¯åŠ ä¹‹å’Œã€‚

é‚£ä¹ˆï¼š

![äºŒç»´å‰ç¼€å’Œ](https://i-blog.csdnimg.cn/direct/a2ba226bce3c4c71971953f4d1bcf1db.png#pic_center)

è§£é‡Šï¼š

å› ä¸ºé»„è‰²éƒ¨åˆ†è¢«å¤šå‡æ‰ä¸€æ¬¡ï¼Œéœ€åŠ å›æ¥ã€‚ç»“åˆå›¾è¿˜æ˜¯æ¯”è¾ƒå¥½ç†è§£çš„

ä½ å¯ä»¥åœ¨çº¿ä½“éªŒ

> [äºŒç»´å‰ç¼€å’Œåœ¨çº¿ä½“éªŒ](https://houbb.github.io/leetcode-visual/T304-prefix-sum-matrix-summary.html)

## ä»£ç å®ç°æ¨¡æ¿ï¼ˆJavaï¼‰

### æ„é€ å‰ç¼€å’Œæ•°ç»„ï¼š

```java
int m = matrix.length, n = matrix[0].length;
int[][] prefix = new int[m+1][n+1];

for (int i = 0; i < m; i++) {
    for (int j = 0; j < n; j++) {
        prefix[i+1][j+1] = prefix[i+1][j] + prefix[i][j+1] - prefix[i][j] + matrix[i][j];
    }
}
```

### æŸ¥è¯¢ä»»æ„çŸ©å½¢å’Œï¼š

```java
int sumRegion(int row1, int col1, int row2, int col2) {
    return prefix[row2+1][col2+1]
         - prefix[row1][col2+1]
         - prefix[row2+1][col1]
         + prefix[row1][col1];
}
```

---

## æ—¶é—´å¤æ‚åº¦

* é¢„å¤„ç†æ„é€ å‰ç¼€å’Œï¼š`O(m * n)`

* æ¯æ¬¡æŸ¥è¯¢ï¼š`O(1)` â€”â€” **éå¸¸å¿«ï¼**

## é€‚ç”¨åœºæ™¯

äºŒç»´å‰ç¼€å’Œéå¸¸é€‚ç”¨äºï¼š

* å¤šæ¬¡æŸ¥è¯¢äºŒç»´åŒºåŸŸå’Œï¼›
* æ£‹ç›˜ç±»é—®é¢˜ã€å›¾åƒå¤„ç†ã€åœ°å›¾ç§¯åˆ†ç­‰ï¼›
* ä»»ä½•éœ€è¦åœ¨çŸ©å½¢åŒºåŸŸå†…åšå’Œ/å¹³å‡/è®¡æ•°çš„é—®é¢˜ã€‚

## å¸¸è§çš„äºŒç»´å‰ç¼€å’Œé¢˜ç›®åˆ—è¡¨

| é¢˜å·             | é¢˜ç›®å                                                                                                              | éš¾åº¦    | æŠ€å·§ç‚¹               |
| -------------- | ---------------------------------------------------------------------------------------------------------------- | ----- | ----------------- |
| **LC 304**     | [äºŒç»´åŒºåŸŸå’Œæ£€ç´¢ - çŸ©é˜µä¸å¯å˜](https://leetcode.cn/problems/range-sum-query-2d-immutable)                                     | ğŸŸ¢ ç®€å• | åŸºç¡€äºŒç»´å‰ç¼€å’Œ           |
| **LC 1314**    | [çŸ©é˜µåŒºåŸŸå’Œ](https://leetcode.cn/problems/matrix-block-sum/)                                                          | ğŸŸ¡ ä¸­ç­‰ | äºŒç»´å‰ç¼€å’Œ + æ»‘åŠ¨çª—å£      |
| **LC 308**ï¼ˆä¼šå‘˜ï¼‰ | [äºŒç»´åŒºåŸŸå’Œæ£€ç´¢ - å¯å˜](https://leetcode.cn/problems/range-sum-query-2d-mutable/)                                         | ğŸ”´ å›°éš¾ | æ ‘çŠ¶æ•°ç»„ / çº¿æ®µæ ‘ï¼ˆåŠ¨æ€å‰ç¼€å’Œï¼‰ |
| **LC 1732**    | [æ‰¾åˆ°æœ€é«˜æµ·æ‹”](https://leetcode.cn/problems/find-the-highest-altitude/)                                                | ğŸŸ¢ ç®€å• | ç±»å‰ç¼€å’Œï¼ˆå¯æ¨å¹¿åˆ°äºŒç»´ï¼‰      |
| **LC 1277**    | [ç»Ÿè®¡å…¨ä¸º 1 çš„æ­£æ–¹å½¢å­çŸ©é˜µ](https://leetcode.cn/problems/count-square-submatrices-with-all-ones/)                           | ğŸŸ¡ ä¸­ç­‰ | å‰ç¼€å’Œä¼˜åŒ–åˆ¤æ–­           |
| **LC 3049**    | [æœ€å¤§è¾¹é•¿çš„æ­£æ–¹å½¢](https://leetcode.cn/problems/largest-side-length-of-square-with-sum-less-than-or-equal-to-threshold/) | ğŸŸ¡ ä¸­ç­‰ | äºŒç»´å‰ç¼€å’Œ + äºŒåˆ†        |

## ğŸ’¡ æ‹“å±•æŠ€å·§

äºŒç»´å‰ç¼€å’Œä¸ä»…å¯ä»¥ç”¨æ¥â€œæŸ¥è¯¢åŒºåŸŸå’Œâ€ï¼Œè¿˜å¯ä»¥æ‹“å±•ä¸ºï¼š

* æŸ¥è¯¢åŒºåŸŸå†…æœ€å¤§/æœ€å°å€¼ï¼ˆé…åˆå•è°ƒé˜Ÿåˆ—ï¼‰
* æŸ¥è¯¢åŒºåŸŸå†…çš„å‡å€¼ã€é¢‘ç‡ï¼ˆå˜ç§å‰ç¼€è®¡æ•°ï¼‰
* å¤šç»´æ•°æ®å¤„ç†ï¼šæ¯”å¦‚å›¾åƒæ»¤æ³¢ã€åŒºåŸŸå·ç§¯ç­‰

# å‚è€ƒèµ„æ–™

* any list
{:toc}