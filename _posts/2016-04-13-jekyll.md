---
layout: post
title:  Jekyll
date:   2016-04-13 23:20:27 +0800
categories: [HTML]
tags: [jekyll]
published: true
---

* any list
{:toc}

# Gem

Install ruby, here is the [download](http://rubyinstaller.org/downloads) address.


# Jekyll

[Jekyll](https://jekyllrb.com/docs/home/) is a simple, blog-aware, static site generator.

> [jekyll doc zh_CN](http://jekyllcn.com)

> [jike zh_CN](http://wiki.jikexueyuan.com/project/jekyll/)


Use command to install jekyll as following.

```
$ gem install jekyll
```

You may need use **Proxy Software** in China. Then, wait and learn how to use it.

Or you can use [rails](https://ruby.taobao.org/) instead of jekyll.

If you are use mac, use this.

```
$ sudo gem install jekyll

```

- Git

You need know how to use Git.

> [Git doc](http://www.runoob.com/git/git-tutorial.html "Git")

# Problem

- Error:  Permission denied - bind(2) for 127.0.0.1:4000

> [bind localhost:4000 failed](http://www.cnblogs.com/lxconan/archive/2016/01/11/5119972.html)

use

```
    $ netstat -ano
    $ tasklist /svc /FI "PID eq ${pid}"
```
pid is the result of thread who occupy localhost:4000; Use task manager to kill this thread;

- Please add the following to your Gemfile to avoid polling for changes:
  gem 'wdm', '>= 0.1.0' if Gem.win_platform?

>  [gem 'wdm', '>= 0.1.0' if Gem.win_platform?](http://stackoverflow.com/questions/30720797/jekyll-install-on-windows-error-message)

I have tried times, but also failed. Luckily, jekyll is still work well.


-  jekyll-paginate

```
Configuration file: /Users/houbinbin/blog/houbb.github.io/_config.yml
  Dependency Error: Yikes! It looks like you don't have jekyll-paginate or one of its dependencies installed. In order to use Jekyll as currently configured, you'll need to install this gem. The full error message from Ruby is: 'cannot load such file -- jekyll-paginate' If you run into trouble, you can find helpful resources at http://jekyllrb.com/help/!
jekyll 3.1.3 | Error:  jekyll-paginate
```

solve method.

```
$ sudo gem install jekyll-paginate

```

# TOC

> [TOC](http://loudou.info/blog/2014/08/01/wei-octopress-tian-jia-toc/)

add these code in your file.

```
* any list
{:toc}
```

# Category

> [category](http://www.tuicool.com/articles/YfMveu)

> [category zh_CN](https://segmentfault.com/a/1190000000406017)

一、 文件夹及数量显示代码

```/``` 防止内容被转义。

```
<h4>Category</h4>
<ul>
  {/% for category in site.categories %}
  <li class="list-unstyled">
    <a href="/categories/{{ category | first }}/" title="view allposts">{{ category | first }} {{ category | last | size }}</a>
  </li>
  {/% endfor %}
</ul>
```

二、为博客添加 category 插件

> [plugin zh_CN](http://wiki.jikexueyuan.com/project/jekyll/plugins.html)

添加 category 插件很简单，只要在根目录下建立一个 **plugins_dir** 文件夹，然后拷贝[category_plugin.rb](https://gist.github.com/pizn/1899497) 文件到里面就好了。

修改 ```_config.yml```

```yml
# 保证插件可用
plugins: ./plugins_dir
safe: false
```

这个插件的作用有两点：

- 建立 **categories** 文件夹, 遍历所有文章的分类，再根据分类建立分类的文件夹。

- 为每个分类建立一个 `index.html` 文件, 该文件的模板来自 **layouts** 里面的 `category_index.html`，因此您需要在 layouts 里面添加符合自己博客主题的文件。

> category_plugin.rb

```ruby
module Jekyll

  class CategoryIndex < Page
    def initialize(site, base, dir, category)
      @site = site
      @base = base
      @dir = dir
      @name = 'index.html'

      self.process(@name)
      self.read_yaml(File.join(base, '_layouts'), 'category_index.html')
      self.data['category'] = category

      category_title_prefix = site.config['category_title_prefix'] || 'Category: '
      self.data['title'] = "#{category_title_prefix}#{category}"
    end
  end

  class CategoryGenerator < Generator
    safe true
    
    def generate(site)
      if site.layouts.key? 'category_index'
        dir = site.config['category_dir'] || 'categories'
        site.categories.keys.each do |category|
          write_category_index(site, File.join(dir, category), category)
        end
      end
    end
  
    def write_category_index(site, dir, category)
      index = CategoryIndex.new(site, site.source, dir, category)
      index.render(site.layouts, site.site_payload)
      index.write(site.dest)
      site.pages << index
    end
  end

end
```

三、category_index.html

```
<ul>

{\% for post in site.categories.[page.category] %}
<li>
    <a class="post-link" href="{{ post.url | prepend: site.baseurl }}">{{ post.title }}</a>
    <span class="post-item-time text-muted f12">
            {{ post.date | date: "%Y-%m-%d %H:%M:%S" }}  |  {{ post.categories }}
      </span>
</li>
{\% endfor %}

</ul>
```


# 分页

> [base page zh_CN](http://wiki.jikexueyuan.com/project/jekyll/pagination.html)

[最多页数限制](https://www.v2ex.com/t/32433)


分页功能插件使得 `paginator` liquid 对象具有下列属性：

|属性|说明|
|:---|:---|
| page				 | 当前页码 |
| per_page			 | 每页文章数量 |
| posts				 | 当前页的文章列表 |
| total_posts			 | 总文章数 |
| total_pages			 | 总页数 |
| previous_page		 | 上一页页码 或 nil（如果上一页不存在）|
| previous_page_path	 | 上一页路径 或 nil（如果上一页不存在）|
| next_page			 | 下一页页码 或 nil（如果下一页不存在）|
| next_page_path		 | 下一页路径 或 nil（如果下一页不存在）|


# Search

> [nice query](http://www.codeboy.me/2016/01/18/jekyll-search-component/)

# SEO









