---
layout: post
title: Cat
date:  2016-12-16 22:01:33 +0800
categories: [Tool]
tags: [cat]
published: true
---

* any list
{:toc}

# Cat

[Cat](https://github.com/houbb/cat) 基于Java开发的实时应用监控平台，包括实时应用监控，业务监控

CAT支持的监控消息类型包括：

- Transaction
    适合记录跨越系统边界的程序访问行为,比如远程调用，数据库调用，也适合执行时间较长的业务逻辑监控，Transaction用来记录一段代码的执行时间和次数。

- Event
    用来记录一件事发生的次数，比如记录系统异常，它和transaction相比缺少了时间的统计，开销比transaction要小。

- Heartbeat
    表示程序内定期产生的统计信息, 如CPU%, MEM%, 连接池状态, 系统负载等。

- Metric
    用于记录业务指标、指标可能包含对一个指标记录次数、记录平均值、记录总和，业务指标最低统计粒度为1分钟。

- Trace
    用于记录基本的trace信息，类似于log4j的info信息，这些信息仅用于查看一些相关信息


# 消息树

CAT监控系统将每次URL、Service的请求内部执行情况都封装为一个完整的消息树、消息树可能包括Transaction、Event、Heartbeat、Metric和Trace信息。

## 完整的消息树

![full tree]({{ site.url}}/static/app/img/cat/2016-12-16-cat-tree-full.png)

## 可视化消息树

![full tree]({{ site.url}}/static/app/img/cat/2016-12-16-cat-tree-view.png)

## 分布式消息树【一台机器调用另外一台机器】

![full tree]({{ site.url}}/static/app/img/cat/2016-12-16-cat-tree-distributed.png)


# Quick Start


1、 Download

```
$   git clone https://github.com/dianping/cat
```

2、 Install

```
$   mvn clean install -DskipTests
```

3、Config cat env

```
$   mvn cat:install

[INFO] Preparing Cat environment...
Please input jdbc url:[jdbc:mysql://127.0.0.1:3306]jdbc:mysql://127.0.0.1:3306
Please input username:root
Please input password:[]123456
[INFO] jdbc.url: jdbc:mysql://127.0.0.1:3306
[INFO] jdbc.user: root
[INFO] jdbc.password: 123456
[INFO] Connecting to database(jdbc:mysql://127.0.0.1:3306) ...
[INFO] Connected to database(jdbc:mysql://127.0.0.1:3306)
[INFO] Creating database(cat) ...
[INFO] Database(cat) is created successfully
[INFO] Creating tables ...
[INFO] Tables are created successfully
```

4、 privilege of ```/data/appdatas/cat``` and ```/data/applogs/cat```

```
[ERROR] Don't have privilege to read/write /data/appdatas/cat, please  manually make this directory
```

create and set privilege

```
$   sudo mkdir /data/appdatas/cat
$   sudo mkdir /data/applogs/cat
$   sudo chmod 777 /data/appdatas/cat
$   sudo chmod 777 /data/applogs/cat
```

5、 Re-Config cat env

```
houbinbindeMacBook-Pro:cat houbinbin$ pwd
/Users/houbinbin/it/code/cat
[INFO] Preparing Cat environment...
Please input jdbc url:[jdbc:mysql://127.0.0.1:3306]jdbc:mysql://127.0.0.1:3306
Please input username:root
Please input password:[]123456
[INFO] jdbc.url: jdbc:mysql://127.0.0.1:3306
[INFO] jdbc.user: root
[INFO] jdbc.password: 123456
[INFO] Connecting to database(jdbc:mysql://127.0.0.1:3306) ...
[INFO] Connected to database(jdbc:mysql://127.0.0.1:3306)
[INFO] Creating database(cat) ...
[INFO] Database 'cat' already exists, drop it first...
[INFO] Database 'cat' has dropped
[INFO] Database(cat) is created successfully
[INFO] Creating tables ...
[INFO] Tables are created successfully
[INFO] Generating the configuration files to /data/appdatas/cat ...
[INFO] Configuration files are generated successfully
[INFO] Preparing Cat environment ... DONE
[INFO] Use following command line to start local Cat server:
[INFO]    cd cat-home; mvn jetty:run
[INFO] Please open http://localhost:2281/cat in your browser
```

6、 Run cat

```
$ cd cat-home
$ mvn jetty:run
```

7. Visit

Input ```http://localhost:2281/cat ``` in your browser:

![cat index]({{ site.url}}/static/app/img/cat/2016-12-17-cat-index.png)


默认用户名密码:

```
root/123456
```


# 部署埋点

文档见:

```
http://localhost:2281/cat/r/home?op=view&docName=deploy
```








