---
layout: post
title:  Java Dev Guide
date:  2017-9-29 08:46:05 +0800
categories: [Java]
tags: [ali, java]
published: true
---


# Java Dev Guide

> [阿里巴巴 Java 开发手册下载](http://techforum-img.cn-hangzhou.oss-pub.aliyun-inc.com/%E9%98%BF%E9%87%8C%E5%B7%B4%E5%B7%B4Java%E5%BC%80%E5%8F%91%E6%89%8B%E5%86%8C%EF%BC%88%E7%BB%88%E6%9E%81%E7%89%88%EF%BC%89.pdf)

愿景：码出高效，码出质量。

此篇规范可以作为自己的编写规范。也可留作日后 team 的开发规范。

以后所有项目，直接引入这一篇规范。


# 编程风格
  
## 命名风格

- 【强制】命名不可以 `_`/`$` 为开始或者结束。

- 【强制】禁止拼音与英文混淆。建议纯英文。

- 【强制】类名遵循 UpperCamelCase。除却 DO/BO/DTO/VO/AO

- 【强制】方法名、参数名、成员变量、局部变量统一使用 lowerCamelCase

- 【强制】常量命名(枚举)全部大写，`_` 分隔。力求完整清晰。

- 【强制】抽象类名以 Abstract/Base 开头。异常类以 Exception 结尾。测试类以类名开始，Test 结尾。

这是一种约定，可以快速分类出类属于哪一部分。比如约定工具类都以 `Util` 结尾。

- 【强制】POJO 类布尔变量，不要加 is。否则部分框架解析会导致序列化错误。

- 【强制】包名统一小写。`.` 分隔符之间仅有一个自然语义的英文单词。包名统一**单数**形式。类名可用复数。

- 【强制】杜绝不规范的缩写。

英文名过长，可进行对应缩写。约定对应缩写规范。

- 【推荐】为了代码自解释。任意元素命名，尽量为完整语义。

- 【推荐】若模块、接口、类、方法使用了设计模式，可以直接命名时体现。

- 【推荐】接口方法/属性不要加任何修饰符。(public 也不应该，因为默认就是。)

- 接口与实现

【强制】Service/DAO 类，基于 [SOA](https://www.ibm.com/developerworks/cn/webservices/ws-soa-design/) 理念。
暴露接口，实现为 Impl 后缀与之区分。

【推荐】形容能力的接口，(-able) 的形式。


- 【推荐】枚举使用 Enum 后缀，常量使用 Constant 后缀。

- Service/DAO 命名规约

觉得原来的文档设计的不够好。可以从区分 DAO/Service 的角度来命名。其他可参考原文档。

DAO: insert/delete/update/select 与 SQL 保持一致。

Service: save/remove/edit/query 等与服务语义保持一致。(可自行约定)

-  领域模型命名规范

1. 数据对象。xxxDO, xxx 为表名

2. 数据传输对象。xxxDTO, xxx 为业务领域相关名称

3. 展示对象。xxxVo， xxx 一般为网页名称。

4. POJO 是以上统称，禁止命名 xxxPOJO。

## 常量定义

- 【强制】代码中禁止直接出现魔法值。(未经定义的常量)

- 【强制】Long 变量初始化时，后缀应使用大写 L。

- 【推荐】常量类应该按照功能归类，分开维护。

- 【推荐】常量的复用广度不同，可分为以下 5 层：

1、跨应用共享变量。放在二方库中。如 client.jar/constant

2、应用内共享变量。放在一方库中。如 modules/constant

3、子工程内共享变量。当前子工程 constant 下。

4、包内共享常量。当前包下单独的 constant 下。

5、类内共享常量。类内部：private static final。

- 【推荐】枚举优于常量就不多言了。

可以多看看《Effective Java》之类的书。

## 代码风格

- 【强制】大括号，默认编辑器格式。

- 【强制】左右括号之间与字符之间不应该有空格。

正：if (a == b)

反： if ( a == b )

- 【强制】if/for/while/switch/do 等保留字与括号之间**必须**加空格。

- 【强制】任何二目、三目运算符的左右两边都需要加一个空格。

- 【强制】采用 4 空格缩进，禁止使用 tab。

IDE 设置 tab 为 4 个空格时，请不要勾选 **Use tab character**;


- 【强制】注释的 `//` 与注释内容之间，**有且仅有**一个空格。

- 【强制】单行字符数不超过 120。(IDE 有个分割线)

1. 换行后。第二行缩进 4 个空格。第三行则不用继续缩进。


- 【强制】多个参数定义传入时，多个参数 `,` 后必须加空格。

- 【强制】IDE 编码统一为 `UTF-8`，换行符统一为 `Unix`，而不是 `Windows`。

- 【推荐】没有必要增加若干空格使得字符对齐。

- 【推荐】不同的语义之间，插入一行空格分隔即可。相同逻辑和语义不需要。

## OOP

- 【强制】避免通过类的对象引用调用访问其静态方法/变量(会增加编译器解析成本)，直接使用 ClassName 访问。

- 【强制】所有方法覆写，添加 `@Override` 注解。

- 【强制】尽量避免使用可变参数编程

有些场景就挺合适的，比如 Arrays.asList(...)

- 【强制】外部正在调用或者二方库依赖的接口，禁止修改方法签名。应使用 `@Depretched` 废弃掉，并注明最新的使用替代方案。

Java 的这个注解没有 .Net 的设计的好，无法注解中指定新的方法是什么。


- 【强制】请勿使用过时的方法/类

- 【强制】比较时，尽量使用确定的值和变量对比。推荐使用 Objects.equals();

正：  

```java
"test".equals(obejct)
```

- 【强制】相同类型的包装类值比较，必须使用 equals();

Integer val = ? (-128~127) 会复用已有对象，大坑。

- 【强制】所有 POJO 都必须为包装数据类型，且不要设置默认值。

保证有些值入库可以为 null，所有校验由使用者保证。

- 【推荐】所有局部变量使用基本数据类型。

- 【强制】序列化类，不要修改 `serialVersionUID`，避免反序列化失败

看过一本书，应该是 《Thinking in Java》。类中其实不需要这个变量，个人建议不要有此属性。
 
- 【强制】构造方法中禁止有业务代码。如果有初始化逻辑，放在 init() 中

- 【强制】POJO 必须添加 toString() 方法。为了日志更容易追踪。

个人建议使用 Commons-lang3 反射实现 ToString(); 自己写项目，为了简单可以使用 lombok。

有一天，系统需要对有些字段进行脱敏。如用户名，手机号，密码。统一使用 Commons-lang3 性能消耗不高，可以统一生成。
对某些字段添加字段，就可脱敏，方便统一管理。当然日志脱敏也是可行的。

- 【推荐】类中的方法应该按照名称顺序等，便于阅读的放在一起。

建议顺序：public > protect > private > getter/setter > toString() > equals()/hashcode()

- 【推荐】getter/setter 方法要保证纯粹。

这一点很好，比如最近我想在 get 的时候，如果没有就默认给个初始值。是在 get 方法中加的业务逻辑，检讨。

个人想法：在获取到之后，在对属性进行默认值初始化等处理。

- 【推荐】 String 循环体字符串的拼接，使用 StringBuilder.append();

- 【推荐】类成员/方法的访问控制从严：

1) 仅仅本类使用，必须为 private;

2) 考虑与子类共享，则为 protect;

3) 不允许 new 来创建，则构造器必须 private;

一句话：尽量将访问级别控制在**最低**。


TBC....




















* any list
{:toc}












 

