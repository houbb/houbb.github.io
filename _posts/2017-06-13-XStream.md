---
layout: post
title:  XStream
date:  2017-6-13 15:30:42 +0800
categories: [XML]
tags: [xStream]
published: true
---

# XStream

[XStream](http://x-stream.github.io/) is a simple library to serialize objects to XML and back again.


> Features

- Ease of use. A high level facade is supplied that simplifies common use cases.

- No mappings required. Most objects can be serialized without need for specifying mappings.

- Performance. Speed and low memory footprint are a crucial part of the design, making it suitable for large object graphs or systems with high message throughput.

- Clean XML. No information is duplicated that can be obtained via reflection. This results in XML that is easier to read for humans and more compact than native Java serialization.

- Requires no modifications to objects. Serializes internal fields, including private and final. Supports non-public and inner classes. Classes are not required to have default constructor.

- Full object graph support. Duplicate references encountered in the object-model will be maintained. Supports circular references.

- Integrates with other XML APIs. By implementing an interface, XStream can serialize directly to/from any tree structure (not just XML).

- Customizable conversion strategies. Strategies can be registered allowing customization of how particular types are represented as XML.

- Security framework. Fine-control about the unmarshalled types to prevent security issues with manipulated input.

- Error messages. When an exception occurs due to malformed XML, detailed diagnostics are provided to help isolate and fix the problem.

- Alternative output format. The modular design allows other output formats. XStream ships currently with JSON support and morphing.

- Typical Uses


# Hello World

<uml>
    Title: XStream Demo
    Object->Xml: Trans object into xml;
    Xml->Obejct: Trans xml into xml;
</uml>

(这个官方的例子稍微有些不够简洁，但是也很容易理解。效果显著)

使用之前，引入Jar

```xml
<dependency>
    <groupId>com.thoughtworks.xstream</groupId>
    <artifactId>xstream</artifactId>
    <version>1.4.9</version>
</dependency>
```

## Obj2Xml

- toXmlTest()

```java
@Test
public void toXmlTest() {
     XStream xstream = new XStream(new StaxDriver());
     xstream.alias("person", Person.class);
     xstream.alias("phoneNum", PhoneNum.class);

     Person joe = new Person();
     joe.setFirstname("hello");
     joe.setLastname("world");
     joe.setPhone(new PhoneNum(123, "1234-456"));
     joe.setFax(new PhoneNum(123, "9999-999"));

     String xml = xstream.toXML(joe);
     System.out.println(xml);
}
```



其中实体类如下(下一个列子也是用此实体类)：

- Person.java

```java
@Data
public class Person {

    private String firstname;

    private String lastname;

    private PhoneNum phone;

    private PhoneNum fax;

}
```

- PhoneNum.java

```java
@Data
public class PhoneNum {
    private int code;
    private String number;

    public PhoneNum(int code, String number) {
        this.code = code;
        this.number = number;
    }
}
```

为了简单，此处不适用日志。直接打印。结果如下:

```xml
<?xml version="1.0" ?><person><firstname>hello</firstname><lastname>world</lastname><phone><code>123</code><number>1234-456</number></phone><fax><code>123</code><number>9999-999</number></fax></person>
```

## Xml2Obj

既然可以将对象转成XML，反之肯定也可以。如下：

- toObjectTest()

```java
@Test
public void toObjectTest() {
     final String xml = "<?xml version=\"1.0\" ?><person><firstname>hello</firstname><lastname>world</lastname><phone><code>123</code><number>1234-456</number></phone><fax><code>123</code><number>9999-999</number></fax></person>";
     XStream xstream = new XStream(new StaxDriver());
     xstream.alias("person", Person.class);
     xstream.alias("phoneNum", PhoneNum.class);
     Person newJoe = (Person)xstream.fromXML(xml);
     System.out.println(newJoe.getFirstname());  
}
```

打印结果:

```
hello
```