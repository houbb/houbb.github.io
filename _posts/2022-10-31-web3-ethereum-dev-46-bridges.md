---
layout: post 
title: web3 以太坊开发-46-链桥 bridges
date: 2022-10-28 21:01:55 +0800
categories: [web3] 
tags: [web3, dev, ethereum, sh]
published: true
---

# 链桥

随着 L1 区块链和 L2 扩展解决方案的普及，以及越来越多的跨链去中心化应用程序，跨链通信和资产移动的需求已成为网络基础设施的重要组成部分。 

存在不同类型的桥梁来帮助实现这一目标。

# 需要桥梁

存在连接区块链网络的桥梁。 

它们支持区块链之间的连接性和互操作性。

区块链存在于孤立的环境中，这意味着区块链无法自然地与其他区块链进行交易和通信。 

因此，虽然一个生态系统内可能有重大的活动和创新，但由于缺乏与其他生态系统的连通性和互操作性而受到限制。

网桥为孤立的区块链环境提供了一种相互连接的方式。 

他们在区块链之间建立了一条运输路线，代币、消息、任意数据甚至智能合约调用都可以从一条链转移到另一条链。

# 桥梁的好处

简而言之，桥梁通过允许区块链网络在它们之间交换数据和移动资产来解锁大量用例。

区块链具有独特的优势、劣势和构建应用程序的方法（例如速度、吞吐量、成本等）。桥梁通过使区块链能够利用彼此的创新来帮助整个加密生态系统的发展。

对于开发人员，网桥可以实现以下功能：

- 跨链传输任何数据、信息和资产。

- 解锁协议的新功能和用例，因为桥接扩展了协议可以提供的设计空间。例如，最初部署在以太坊主网上的收益农业协议可以在所有与 EVM 兼容的链上提供流动性池。

- 有机会利用不同区块链的优势。例如，开发人员可以通过跨汇总部署他们的 dapp，而侧链和用户可以跨过它们，从而从不同的 L2 解决方案提供的较低费用中受益。

- 来自各种区块链生态系统的开发人员之间的协作以构建新产品。

- 吸引来自不同生态系统的用户和社区使用他们的 dapp。

# 桥梁如何运作？

虽然桥接设计的类型很多，但促进资产跨链转移的三种方式脱颖而出：

Lock and mint – 锁定源链上的资产和目标链上的铸币资产。

烧毁和铸币——在源链上烧毁资产，在目的链上铸币资产。

原子交换——将源链上的资产与另一方交换目标链上的资产。

# 桥梁类型

桥梁通常可以分为以下类别之一：

原生桥——这些桥通常用于引导特定区块链上的流动性，使用户更容易将资金转移到生态系统。 

例如，Arbitrum Bridge 的构建是为了方便用户从以太坊主网桥接到 Arbitrum。 

其他此类网桥包括 Polygon PoS Bridge、Optimism Gateway 等。

基于验证器或预言机的桥——这些桥依赖于外部验证器集或预言机来验证跨链转移。 

示例：多链和跨链。

通用消息传递桥——这些桥可以跨链传输资产、消息和任意数据。 

示例：Nomad 和 LayerZero。

流动性网络——这些桥梁主要专注于通过原子交换将资产从一条链转移到另一条链。 

通常，它们不支持跨链消息传递。 

示例：Connext 和 Hop。

# 需要考虑的权衡

对于桥梁，没有完美的解决方案。相反，只有为了实现某个目的而进行权衡。

开发人员和用户可以根据以下因素评估桥梁：

安全性——谁来验证系统？由外部验证器保护的桥通常不如由区块链验证器在本地或本地保护的桥安全。

便利性——完成一笔交易需要多长时间，用户需要签署多少笔交易？

对于开发人员来说，集成一个桥需要多长时间，过程有多复杂？

连接性——桥可以连接哪些不同的目标链（即汇总、侧链、其他第 1 层区块链等），集成新区块链的难度如何？

传递更复杂数据的能力——桥能否实现跨链的消息和更复杂的任意数据的传输，还是仅支持跨链资产传输？

成本效益——通过桥梁跨链转移资产需要多少成本？

通常，桥梁根据天然气成本和特定路线的流动性收取固定或可变费用。

根据确保桥梁安全所需的资金来评估桥梁的成本效益也很重要。

在高层次上，网桥可以分为可信和不可信。

受信任——受信任的网桥经过外部验证。他们使用一组外部验证者（具有多重签名的联盟、多方计算系统、预言机网络）跨链发送数据。

因此，它们可以提供出色的连接性并实现跨链的完全通用的消息传递。它们还往往在速度和成本效益方面表现良好。这是以安全为代价的，因为用户必须依赖网桥的安全性。

无信任——这些桥依赖于它们连接的区块链及其验证器来传输消息和令牌。它们是“不信任的”，因为它们不添加新的信任假设（除了区块链）。

因此，无信任网桥被认为比受信网桥更安全。

为了根据其他因素评估去信任的桥梁，我们必须将它们分解为广义的消息传递桥梁和流动性网络。

通用消息传递桥——这些桥在安全性和跨链传输更复杂数据的能力方面表现出色。

通常，它们的成本效益也很好。然而，这些优势通常是以轻客户端网桥（例如：IBC）的连接性和使用欺诈证明的乐观网桥（例如：Nomad）的速度缺陷为代价的。

流动性网络——这些桥梁使用原子交换来转移资产，并且是本地验证系统（即，它们使用底层区块链的验证器来验证交易）。

因此，它们在安全性和速度方面表现出色。

此外，它们被认为具有相对成本效益并提供良好的连接性。然而，主要的权衡是它们无法传递更复杂的数据——因为它们不支持跨链消息传递。


# 桥梁风险

Bridges 是 DeFi 中最大的三大黑客攻击，仍处于早期开发阶段。使用任何网桥都会带来以下风险：

智能合约风险——虽然许多桥梁已成功通过审核，但只要智能合约中的一个缺陷，资产就会受到黑客攻击（例如：Solana 的虫洞桥）。

系统性金融风险——许多桥梁使用包装资产在新链上铸造原始资产的规范版本。这使生态系统面临系统性风险，正如我们已经看到被利用的代币包装版本。

交易对手风险——一些桥使用可信设计，要求用户依赖验证者不会串通盗取用户资金的假设。用户需要信任这些第三方参与者，这使他们面临诸如拉扯地毯、审查和其他恶意活动等风险。

未解决的问题——鉴于网桥处于发展的初期阶段，有许多未解决的问题与网桥在不同市场条件下的表现有关，例如网络拥塞时以及在网络级攻击或状态回滚等不可预见的事件期间。

这种不确定性带来了一定的风险，其程度仍然未知。

# DApps 如何使用桥接器？

以下是开发人员可以考虑的一些关于桥接和 dapp 跨链的实际应用：

## 整合桥梁

对于开发人员，有很多方法可以添加对桥接器的支持：

建造自己的桥梁——建造一座安全可靠的桥梁并不容易，尤其是在您采用信任度最低的路线时。此外，它需要多年与可扩展性和互操作性研究相关的经验和技术专长。此外，这将需要一个动手团队来维护一座桥梁并吸引足够的流动性以使其可行。

向用户展示多个桥接选项——许多 dapp 要求用户拥有他们的原生代币才能与他们交互。为了使用户能够访问他们的代币，他们在其网站上提供了不同的桥接选项。但是，这种方法可以快速解决问题，因为它使用户远离 dapp 界面，并且仍然需要他们与其他 dapp 和桥接器进行交互。随着犯错范围的增加，这是一种繁琐的入职体验。

集成网桥——该解决方案不需要 dapp 将用户发送到外部网桥和 DEX 接口。它允许 dapps 改善用户的入职体验。但是，这种方法有其局限性：

桥梁的评估和维护既困难又费时。
选择一个网桥会产生单点故障和依赖性。
dapp 受到网桥功能的限制。
仅靠桥梁可能还不够。 dapps 可能需要 DEX 来提供更多功能，例如跨链交换。
集成多个网桥——该解决方案解决了与集成单个网桥相关的许多问题。但是，它也有局限性，因为集成多个网桥会消耗资源，并为开发人员带来技术和通信开销——这是加密货币中最稀缺的资源。

集成网桥聚合器——dapps 的另一个选择是集成网桥聚合解决方案，使它们能够访问多个网桥。网桥聚合器继承了所有网桥的优势，因此不受任何单个网桥功能的限制。值得注意的是，桥接聚合器通常会维护桥接集成，这使 dapp 免于掌握桥接集成的技术和运营方面的麻烦。

话虽如此，桥接聚合器也有其局限性。例如，虽然它们可以提供更多的桥接选项，但市场上通常有更多的桥接，而不是聚合器平台上提供的桥接。此外，就像桥梁一样，桥梁聚合器也面临智能合约和技术风险（更多智能合约 = 更多风险）。

如果 dapp 沿着集成桥接器或聚合器的路线发展，则根据集成的深度有不同的选择。例如，如果它只是一个前端集成来改善用户入职体验，那么 dapp 将集成小部件。但是，如果集成是为了探索更深层次的跨链策略，如 Staking、Yield Farming 等，则 dapp 集成了 SDK 或 API。

## 在多个链上部署 dapp

要在多条链上部署 dapp，开发人员可以使用 Alchemy、Hardhat、Truffle、Moralis 等开发平台。

通常，这些平台带有可组合的插件，可以使 dapp 跨链。 

例如，开发人员可以使用 hardhat-deploy 插件提供的确定性部署代理。

例子：

- [如何构建跨链 dapp](https://moralis.io/how-to-build-cross-chain-dapps/)

- [构建跨链 NFT 市场](https://youtu.be/WZWCzsB1xUE)

- [Moralis：构建跨链 NFT dapp](https://www.youtube.com/watch?v=ehv70kE1QYo)

## 跨链监控合约活动

为了监控跨链的合约活动，开发人员可以使用子图和 Tenderly 等开发人员平台实时观察智能合约。 

此类平台还具有为跨链活动提供更强大的数据监控功能的工具，例如检查合约发出的事件等。

# 参考资料

https://ethereum.org/zh/developers/docs/bridges/

* any list
{:toc}